var Oe=Object.defineProperty;var Be=(r,o,e)=>o in r?Oe(r,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[o]=e;var _e=(r,o,e)=>(Be(r,typeof o!="symbol"?o+"":o,e),e);import{E as $,d as N,o as p,c as P,O as n,R as l,u,a as V,al as me,am as fe,an as ve,i as L,z as te,a0 as Z,_ as q,S as b,V as h,W as A,T as oe,X as S,$ as D,F as K,n as Re,w as W,G as Le,P as R,ah as he,L as j,ad as je,J as ne,h as Fe,e as qe,A as be,D as Me,I as De,ao as He}from"./@vue-293b23a6.js";import{E as Ke,a as G,b as F,u as se,c as ee,d as ye,C as ge,e as le,f as z,g as We,h as Ge,i as Je,j as xe,k as Xe,l as Ye,m as Ze,n as Qe,w as ke,o as et,p as tt,q as ot,r as nt,s as $e,t as st,v as lt,x as at,y as Ve,z as ae,A as dt,B as rt,D as ut,F as it}from"./element-plus-3e504284.js";import{p as we,k as Ce,m as Ee,n as Ne,o as ct,a as pt,r as _t,t as mt,u as ft,x as vt,y as ht}from"./@element-plus-cc1fdafb.js";import{h as J,j as de}from"./@vueuse-1aeb377c.js";import{a as bt}from"./axios-21b846bc.js";import{c as yt}from"./vite-plugin-mock-a6c9e661.js";import"./lodash-es-90b76008.js";import"./async-validator-dee29e8b.js";import"./@sxzz-c75af06c.js";import"./@ctrl-f8748455.js";import"./mockjs-26f03dd7.js";import"./dayjs-725317a4.js";import"./path-to-regexp-31db6522.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const d of s)if(d.type==="childList")for(const a of d.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const d={};return s.integrity&&(d.integrity=s.integrity),s.referrerPolicy&&(d.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?d.credentials="include":s.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function t(s){if(s.ep)return;s.ep=!0;const d=e(s);fetch(s.href,d)}})();const re=r=>(me("data-v-e5f31a23"),r=r(),fe(),r),gt={class:"add-but"},xt={class:"node-select"},kt=re(()=>V("span",null,"审批人",-1)),$t=re(()=>V("span",null,"抄送人",-1)),Vt=re(()=>V("span",null,"互斥分支",-1)),wt=$({__name:"index",emits:["addNode"],setup(r,{emit:o}){const e=N(),t=()=>{var a;o("addNode","approval"),(a=e.value)==null||a.hide()},s=()=>{var a;o("addNode","cc"),(a=e.value)==null||a.hide()},d=()=>{var a;o("addNode","exclusive"),(a=e.value)==null||a.hide()};return(a,_)=>{const y=G,f=F,i=Ke;return p(),P("div",gt,[n(i,{placement:"bottom-start",ref_key:"nodePopoverRef",ref:e,trigger:"click",title:"添加节点",width:235},{reference:l(()=>[n(f,{icon:u(we),type:"primary",style:{"z-index":"1"},circle:""},null,8,["icon"])]),default:l(()=>[V("div",xt,[V("div",{onClick:t},[n(y,{color:"#ff943e"},{default:l(()=>[n(u(Ce))]),_:1}),kt]),V("div",{onClick:s},[n(y,{color:"#3296fa"},{default:l(()=>[n(u(Ee))]),_:1}),$t]),V("div",{onClick:d},[n(y,null,{default:l(()=>[n(u(Ne))]),_:1}),Vt])])]),_:1},512)])}}});const T=(r,o)=>{const e=r.__vccOpts||r;for(const[t,s]of o)e[t]=s;return e},Pe=T(wt,[["__scopeId","data-v-e5f31a23"]]),Ct={class:"node-box"},Et={class:"head"},Nt={key:2},Pt=$({__name:"index",props:{icon:{},node:{},color:{},readOnly:{type:Boolean,default:!1},close:{type:Boolean,default:!0}},emits:["update:node"],setup(r,{emit:o}){const e=r;ve(C=>({"7fef6931":f.value,"69b1a708":y.value,"7c904ba0":C.color}));const t={list:_t,stamp:Ce,share:Ne,promotion:Ee},{node:s}=J(e,o),d=N(!1),a=N(),_=se(),y=L(()=>ee[_.value||"default"]+205+"px"),f=L(()=>ee[_.value||"default"]+60+"px"),{addNode:i,delNode:c,openPenal:v}=te("nodeHooks"),m=()=>{e.readOnly||v(s.value)},w=()=>{e.readOnly||(d.value=!0,Re(()=>{var C;(C=a.value)==null||C.focus()}))},I=()=>{d.value&&(d.value=!1)};return(C,g)=>{const k=G,x=z,E=F,O=We,M=ye;return p(),P("div",Ct,[n(M,{shadow:"always",onClick:g[4]||(g[4]=B=>m()),class:"node"},{header:l(()=>[V("div",Et,[d.value?(p(),P("div",{key:0,onClick:g[1]||(g[1]=Z(()=>{},["stop"]))},[q(n(u(le),{ref_key:"inputRef",ref:a,onBlur:I,maxlength:"30",modelValue:u(s).name,"onUpdate:modelValue":g[0]||(g[0]=B=>u(s).name=B)},null,8,["modelValue"]),[[u(ge),I]])])):(p(),b(x,{key:1,tag:"b",truncated:"",onClick:Z(w,["stop"])},{default:l(()=>[h(A(u(s).name)+" ",1),n(k,null,{default:l(()=>[n(u(ct))]),_:1})]),_:1},8,["onClick"])),C.icon?(p(),P("span",Nt,[n(k,{size:30,color:"node-icon"},{default:l(()=>[(p(),b(oe(t[C.icon.toLowerCase()])))]),_:1})])):S("",!0)])]),default:l(()=>[V("div",{onClick:g[3]||(g[3]=Z(()=>{},["stop"]))},[n(O,{title:"您确定要删除该节点吗？",width:"200","hide-after":0,placement:"right-start",onConfirm:g[2]||(g[2]=B=>u(c)(u(s)))},{reference:l(()=>[q(n(E,{class:"node-close",plain:"",circle:"",icon:u(pt),size:"small",type:"danger"},null,8,["icon"]),[[D,C.close&&!C.readOnly]])]),_:1})]),K(C.$slots,"default",{},void 0,!0)]),_:3}),n(Pe,{onAddNode:g[5]||(g[5]=B=>u(i)(B,u(s)))})])}}});const X=T(Pt,[["__scopeId","data-v-bbfe743d"]]),It=$({__name:"content",props:{node:{}},setup(r){const o=r,e=N("");return W(()=>{e.value=o.node.name}),(t,s)=>{const d=z;return p(),b(d,null,{default:l(()=>[h(A(e.value||t.node.name),1)]),_:1})}}}),Tt={class:"start-box"},At=$({__name:"index",props:{node:{}},setup(r){return(o,e)=>(p(),P("div",Tt,[n(X,{icon:"List",close:!1,color:"linear-gradient(89.96deg, #7B68EE .05%, #7B68EE 79.83%)",node:o.node},{default:l(()=>[n(It,{node:o.node},null,8,["node"])]),_:1},8,["node"])]))}});const St=T(At,[["__scopeId","data-v-b16cf523"]]),Ut={baseURL:"/api",timeout:8e3};class zt{constructor(o){_e(this,"service");this.service=bt.create(o),this.service.interceptors.request.use(e=>(e.headers.Authorization="Bearer 87779e5a-3342-4df6-865d-d8828800d6fb",e),e=>Promise.reject(e)),this.service.interceptors.response.use(e=>{const{data:t}=e;return t},e=>{const{response:t,message:s}=e,d=t==null?void 0:t.data,a=d?d.message:s;return Ge.error(a||"未知错误"),Promise.reject((t==null?void 0:t.data)||e)})}get(o,e,t={}){return this.service.get(o,{params:e,...t})}post(o,e){return this.service.post(o,e)}put(o,e){return this.service.put(o,e)}delete(o,e){return this.service.delete(o,e)}patch(o,e){return this.service.patch(o,e)}head(o){return this.service.head(o)}options(o){return this.service.options(o)}request(o){return this.service.request(o)}download(o,e){return this.service.post(o,e,{responseType:"blob"})}}const Ie=new zt(Ut),Ot=r=>Ie.get("/user/info",{username:r}),H=r=>{const o=r?{userIds:r}:{};return Ie.post("/user/list",o)},Bt=$({__name:"content",props:{node:{}},setup(r){const o=r,e=N("");return W(()=>{const t=o.node;t.assigneeType==="choice"?e.value=`发起人自选（${t.choice?"单选":"多选"}）`:t.assigneeType==="self"?e.value="发起人自己":t.assigneeType==="leader"?e.value=t.leader===1?"直属上级":`${t.leader}级上级`:t.assigneeType==="formUser"?e.value="表单内人员":t.assigneeType==="user"?t.users.length>0?H(t.users).then(s=>{s.success&&(e.value=s.data.map(d=>d.name).join("、"))}):e.value="未指定人员":t.assigneeType==="role"?t.roles.length>0||(e.value="未指定角色"):e.value=o.node.name}),(t,s)=>{const d=z;return p(),b(d,null,{default:l(()=>[h(A(e.value||t.node.name),1)]),_:1})}}}),Rt=$({__name:"index",props:{node:{}},setup(r){return(o,e)=>(p(),b(X,{icon:"Stamp",color:"linear-gradient(89.96deg, #FA6F32 .05%, #FB9337 79.83%)",node:o.node},{default:l(()=>[n(Bt,{node:o.node},null,8,["node"])]),_:1},8,["node"]))}}),Lt=$({__name:"content",props:{node:{}},setup(r){const o=r,e=N("");return W(()=>{const t=o.node;t.users.length>0?H(t.users).then(s=>{s.success&&(e.value=s.data.map(d=>d.name).join("、"))}):e.value="未指定人员"}),(t,s)=>{const d=z;return p(),b(d,null,{default:l(()=>[h(A(e.value||t.node.name),1)]),_:1})}}}),jt=$({__name:"index",props:{node:{}},setup(r){return(o,e)=>(p(),b(X,Le({icon:"Promotion"},o.$attrs,{color:"rgb(50, 150, 250)",node:o.node}),{default:l(()=>[n(Lt,{node:o.node},null,8,["node"])]),_:1},16,["node"]))}}),Ft=$({__name:"content",props:{node:{}},setup(r){const o=r,e=N("");return W(()=>{o.node.def?e.value="不满足条件时，进入默认条件":e.value="未设置条件"}),(t,s)=>{const d=z;return p(),b(d,null,{default:l(()=>[h(A(e.value||t.node.name),1)]),_:1})}}}),qt={class:"condition-box"},Mt=$({__name:"index",props:{node:{}},setup(r){return(o,e)=>(p(),P("div",qt,[n(X,{icon:"Share",readOnly:o.node.def,node:o.node},{default:l(()=>[n(Ft,{node:o.node},null,8,["node"])]),_:1},8,["readOnly","node"])]))}});const Dt=T(Mt,[["__scopeId","data-v-a8dbd11f"]]),Y=r=>(me("data-v-fc3aba84"),r=r(),fe(),r),Ht={class:"branch-node"},Kt={class:"add-branch"},Wt=Y(()=>V("div",{class:j("top-right-border")},null,-1)),Gt=Y(()=>V("div",{class:j("bottom-right-border")},null,-1)),Jt=Y(()=>V("div",{class:j("top-left-border")},null,-1)),Xt=Y(()=>V("div",{class:j("bottom-left-border")},null,-1)),Yt=$({__name:"index",props:{node:{}},setup(r){const{addNode:o}=te("nodeHooks");return(e,t)=>(p(),P(R,null,[V("div",Ht,[V("div",Kt,[K(e.$slots,"default",{},void 0,!0)]),(p(!0),P(R,null,he(e.node.children,(s,d)=>(p(),P("div",{key:s.id,class:"col-box"},[e.node.children.length===d+1?(p(),P(R,{key:0},[Wt,Gt],64)):S("",!0),d===0?(p(),P(R,{key:1},[Jt,Xt],64)):S("",!0),n(Te,{node:s},null,8,["node"])]))),128))]),n(Pe,{onAddNode:t[0]||(t[0]=s=>u(o)(s,e.node)),class:"branch-but"})],64))}});const Zt=T(Yt,[["__scopeId","data-v-fc3aba84"]]),Qt=$({__name:"index",props:{node:{}},setup(r){const{addNode:o}=te("nodeHooks");return(e,t)=>{const s=F;return p(),b(Zt,{node:e.node},{default:l(()=>[n(s,{type:"primary",onClick:t[0]||(t[0]=d=>u(o)("condition",e.node)),plain:"",round:""},{default:l(()=>[h("添加条件")]),_:1})]),_:1},8,["node"])}}});const eo={},to={class:"node-box"};function oo(r,o){const e=z;return p(),P("div",to,[n(e,{class:"end-node"},{default:l(()=>[h(" 结束 ")]),_:1})])}const no=T(eo,[["render",oo],["__scopeId","data-v-80fc01b0"]]),so=$({name:"NodeTree"}),lo=$({...so,props:{node:{}},setup(r){const o={start:St,approval:Rt,cc:jt,condition:Dt,exclusive:Qt,end:no};return(e,t)=>{const s=je("NodeTree");return p(),P(R,null,[K(e.$slots,"default",{},void 0,!0),(p(),b(oe(o[e.node.type]),{node:e.node},null,8,["node"])),e.node.child?(p(),b(s,{key:0,node:e.node.child},null,8,["node"])):S("",!0)],64)}}});const Te=T(lo,[["__scopeId","data-v-1288ab88"]]),ao={class:"flex-center",style:{gap:"4px","grid-gap":"4px"}},ro=$({__name:"UserTag",props:{username:{},type:{default:"info"},closable:{type:Boolean,default:!1}},emits:["close"],setup(r,{emit:o}){const e=r;let t=ne({username:void 0,avatar:void 0,name:void 0});Fe(()=>{if(!e.username)throw new Error("username is required");Ot(e.username).then(_=>{_.success&&(t.username=_.data.username,t.avatar=_.data.avatar,t.name=_.data.name)})}),L(()=>{const _="/api";return _.startsWith("http")?_:window.location.origin+_});const s=se(),d=L(()=>ee[s.value||"default"]-12),a=()=>{o("close",e.username)};return(_,y)=>{const f=xe,i=Je;return p(),b(i,{round:"",closable:e.closable,type:_.type,effect:"light",onClose:a},{default:l(()=>[V("div",ao,[n(f,{size:d.value,src:u(t).avatar},{default:l(()=>[h(A((u(t).name||_.username).charAt(0)),1)]),_:1},8,["size","src"]),V("span",null,A(u(t).name||_.username),1)])]),_:1},8,["closable","type"])}}});const ue=T(ro,[["__scopeId","data-v-11e894be"]]),uo={class:"flex flex-1 flex-items-center flex-justify-between"},io={class:"flex-center"},co=$({__name:"UserPicker",props:{modelValue:{},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{expose:o,emit:e}){const t=r,s={label:"name",children:"children",isLeaf:"leaf",class:k=>i(k)},d=de(t,"modelValue",e),a=N([]),_=N([]),y=N(),f=N([]),i=k=>a.value.find(E=>E.id===k.id)?"is-active":"",c=k=>{if(k.type==="user")if(t.multiple){const x=a.value.findIndex(E=>E.id===k.id);x===-1?(a.value.push(k),a.value.sort((E,O)=>E.id.localeCompare(O.id))):a.value.splice(x,1)}else{const x=a.value.findIndex(E=>E.id===k.id);x===-1?a.value=[k]:a.value.splice(x,1)}},v=N(!1),m=ne({name:null});qe(()=>m.name,k=>{var x;(x=y.value)==null||x.filter(k)});const w=(k,x)=>k?x.name.includes(k):!0,I=()=>{v.value=!0},C=()=>{H().then(x=>{x.success&&(_.value=x.data.map(E=>({id:E.username,name:E.name,type:"user",leaf:!0,avatar:E.avatar})))});let k=[];Array.isArray(d.value)?k.push(...d.value):d.value&&k.push(d.value),k.length>0?H(k).then(x=>{x.success&&(a.value=x.data.map(E=>({id:E.username,name:E.name,avatar:E.avatar,type:"user",leaf:!0})),a.value.sort((E,O)=>E.id.localeCompare(O.id)))}):a.value=[]},g=()=>{t.multiple?d.value=a.value.map(k=>k.id):a.value.length>0?d.value=a.value[0].id:d.value=null,v.value=!1};return o({open:I}),(k,x)=>{const E=le,O=xe,M=G,B=Ye,Se=Ze,Ue=ye,pe=F,ze=Xe;return p(),b(ze,{modelValue:v.value,"onUpdate:modelValue":x[2]||(x[2]=U=>v.value=U),onOpen:C,"align-center":"",draggable:"",title:"选择用户",width:"30%"},{footer:l(()=>[n(pe,{onClick:x[1]||(x[1]=U=>v.value=!1)},{default:l(()=>[h("取消")]),_:1}),n(pe,{type:"primary",onClick:g},{default:l(()=>[h("确认")]),_:1})]),default:l(()=>[n(Ue,{shadow:"never",class:"org-card"},{header:l(()=>[n(E,{modelValue:m.name,"onUpdate:modelValue":x[0]||(x[0]=U=>m.name=U),placeholder:"输入关键字进行查询",style:{width:"100%"},"suffix-icon":"search",clearable:""},null,8,["modelValue"])]),default:l(()=>[n(Se,{tag:"div",class:"org-tree"},{default:l(()=>[n(B,{ref_key:"orgTreeRef",ref:y,"node-key":"id",data:_.value,"default-expanded-keys":f.value,props:s,"filter-node-method":w,onNodeClick:c},{default:l(({data:U})=>[V("div",uo,[V("div",io,[U.type==="user"?(p(),b(O,{key:0,size:25,src:U.avatar},{default:l(()=>[h(A(U.name.charAt(0)),1)]),_:2},1032,["src"])):(p(),b(M,{key:1,size:16},{default:l(()=>[n(u(mt))]),_:1})),h("  "+A(U.name),1)]),n(M,{class:"is-selected"},{default:l(()=>[n(u(ft))]),_:1})])]),_:1},8,["data","default-expanded-keys"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const ie=T(co,[["__scopeId","data-v-ff83d1b0"]]),po={class:"user-wrapper"},_o=$({__name:"UserSelector",props:{modelValue:{},placeholder:{default:"请选择用户"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},style:{}},emits:["update:modelValue"],setup(r,{emit:o}){const e=r,t=de(e,"modelValue",o),s=L(()=>t.value?Array.isArray(t.value)?t.value:[t.value]:[]),d=N(),a=Qe(),_=se(),y=L(()=>a.value||e.disabled),f=()=>{var c;(c=d.value)==null||c.open()},i=c=>{t.value&&(e.multiple&&Array.isArray(t.value)?t.value.splice(t.value.indexOf(c),1):t.value=null)};return(c,v)=>{const m=G,w=F,I=z;return p(),P(R,null,[n(ie,{ref_key:"userPickerRef",ref:d,multiple:c.multiple,modelValue:u(t),"onUpdate:modelValue":v[0]||(v[0]=C=>be(t)?t.value=C:null)},null,8,["multiple","modelValue"]),V("div",po,[n(w,{class:"user-but-item",size:u(_),disabled:y.value,onClick:f,circle:""},{default:l(()=>[n(m,null,{default:l(()=>[n(u(vt))]),_:1})]),_:1},8,["size","disabled"]),(p(!0),P(R,null,he(s.value,C=>(p(),b(ue,{closable:!y.value,key:C,username:C,onClose:i},null,8,["closable","username"]))),128)),q(n(I,{class:"placeholder"},{default:l(()=>[h(A(c.placeholder),1)]),_:1},512),[[D,!u(t)||u(t).length===0]])])],64)}}});const mo=T(_o,[["__scopeId","data-v-5138c0fc"]]);ke(ue);ke(ie);const Ae=et(mo,{userTag:ue,userPicker:ie}),fo=$({__name:"index",props:{block:{type:Boolean,default:!0},modelValue:{}},emits:["update:modelValue"],setup(r,{emit:o}){const t=de(r,"modelValue",o);return(s,d)=>{const a=tt;return p(),b(a,{modelValue:u(t),"onUpdate:modelValue":d[0]||(d[0]=_=>be(t)?t.value=_:null),class:j(["el-segmented",{"is-block":s.block}])},{default:l(()=>[K(s.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue","class"])}}});const ce=T(fo,[["__scopeId","data-v-6406405a"]]),vo=$({__name:"ApprovalAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:o}){const e=r,t=N("properties"),{node:s}=J(e,o);return(d,a)=>{const _=ot,y=nt,f=$e,i=Ae,c=st,v=z,m=lt,w=at,I=Ve,C=ae;return p(),b(u(ce),{modelValue:t.value,"onUpdate:modelValue":a[6]||(a[6]=g=>t.value=g),stretch:"",block:!1},{default:l(()=>[n(C,{label:"设置审批人",name:"properties"},{default:l(()=>[n(I,{"label-position":"top","label-width":"90px"},{default:l(()=>[n(f,{prop:"assigneeType",label:"审批对象"},{default:l(()=>[n(y,{modelValue:u(s).assigneeType,"onUpdate:modelValue":a[0]||(a[0]=g=>u(s).assigneeType=g)},{default:l(()=>[n(_,{label:"user"},{default:l(()=>[h("指定人员")]),_:1}),n(_,{label:"role"},{default:l(()=>[h("指定角色")]),_:1}),n(_,{label:"choice"},{default:l(()=>[h("发起人自选")]),_:1}),n(_,{label:"self"},{default:l(()=>[h("发起人自己")]),_:1}),n(_,{label:"leader"},{default:l(()=>[h("多级上级")]),_:1}),n(_,{label:"formUser"},{default:l(()=>[h("表单内人员")]),_:1}),n(_,{label:"formRole"},{default:l(()=>[h("表单内角色")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(s).assigneeType==="user"?(p(),b(f,{key:0,prop:"users",label:"指定人员"},{default:l(()=>[n(i,{multiple:"",placeholder:"请选择人员",modelValue:u(s).users,"onUpdate:modelValue":a[1]||(a[1]=g=>u(s).users=g)},null,8,["modelValue"])]),_:1})):S("",!0),u(s).assigneeType==="choice"?(p(),b(f,{key:1,prop:"selfSelect",label:"发起人自选择"},{default:l(()=>[n(y,{modelValue:u(s).choice,"onUpdate:modelValue":a[2]||(a[2]=g=>u(s).choice=g)},{default:l(()=>[n(c,{label:!1},{default:l(()=>[h("单选")]),_:1}),n(c,{label:!0},{default:l(()=>[h("多选")]),_:1})]),_:1},8,["modelValue"])]),_:1})):S("",!0),u(s).assigneeType==="self"?(p(),b(f,{key:2,prop:"self",label:"发起人自己"},{default:l(()=>[n(v,null,{default:l(()=>[h(" 发起人自己作为审批人进行审批 ")]),_:1})]),_:1})):S("",!0),u(s).assigneeType==="leader"?(p(),b(f,{key:3,prop:"leader",label:"直属上级"},{default:l(()=>[n(w,{modelValue:u(s).leader,"onUpdate:modelValue":a[3]||(a[3]=g=>u(s).leader=g),placeholder:"请选择直属上级"},{default:l(()=>[n(m,{label:"直属上级",value:1}),n(m,{label:"二级上级",value:2}),n(m,{label:"三级上级",value:3}),n(m,{label:"四级上级",value:4}),n(m,{label:"五级上级",value:5}),n(m,{label:"六级上级",value:6}),n(m,{label:"七级上级",value:7}),n(m,{label:"八级上级",value:8}),n(m,{label:"九级上级",value:9}),n(m,{label:"十级上级",value:10}),n(m,{label:"十一级上级",value:11})]),_:1},8,["modelValue"])]),_:1})):S("",!0),u(s).assigneeType==="role"?(p(),b(f,{key:4,prop:"roles",label:"指定角色"},{default:l(()=>[h(" 待添加... ")]),_:1})):S("",!0),u(s).assigneeType==="formUser"?(p(),b(f,{key:5,prop:"formUser",label:"表单内人员"},{default:l(()=>[h(" 待添加... ")]),_:1})):S("",!0),u(s).assigneeType==="formRole"?(p(),b(f,{key:6,prop:"formRole",label:"表单内角色"},{default:l(()=>[h(" 待添加... ")]),_:1})):S("",!0),n(f,{prop:"method",label:"多人审批方式"},{default:l(()=>[n(y,{class:"flex-column",modelValue:u(s).method,"onUpdate:modelValue":a[4]||(a[4]=g=>u(s).method=g)},{default:l(()=>[n(_,{label:"sequential"},{default:l(()=>[h("依次审批")]),_:1}),n(_,{label:"multi"},{default:l(()=>[h("会签（需要所有审批人都同意才可通过）")]),_:1}),n(_,{label:"anyone"},{default:l(()=>[h("或签（其中一名审批人同意或拒绝即可）")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(f,{prop:"nobody",label:"审批人为空"},{default:l(()=>[n(y,{modelValue:u(s).nobody,"onUpdate:modelValue":a[5]||(a[5]=g=>u(s).nobody=g)},{default:l(()=>[n(_,{label:"pass"},{default:l(()=>[h("自动通过")]),_:1}),n(_,{label:"reject"},{default:l(()=>[h("自动驳回")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(C,{label:"表单权限",name:"formPermissions"},{default:l(()=>[h(" 待添加... ")]),_:1}),n(C,{label:"操作权限",name:"operationPermissions"},{default:l(()=>[h(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}});const ho=T(vo,[["__scopeId","data-v-5653487f"]]),bo=$({__name:"CcAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:o}){const e=r,t=N("properties"),{node:s}=J(e,o);return(d,a)=>{const _=Ae,y=$e,f=Ve,i=ae;return p(),b(u(ce),{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=c=>t.value=c),stretch:"",block:!1},{default:l(()=>[n(i,{label:"设置抄送人",name:"properties"},{default:l(()=>[n(f,{"label-position":"top","label-width":"90px"},{default:l(()=>[n(y,{prop:"users",label:"抄送人"},{default:l(()=>[n(_,{multiple:"",placeholder:"请选择人员",modelValue:u(s).users,"onUpdate:modelValue":a[0]||(a[0]=c=>u(s).users=c)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(i,{label:"表单权限",name:"formPermissions"},{default:l(()=>[h(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),yo=$({__name:"StartAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:o}){const e=r,t=N("formPermissions");return J(e,o),(s,d)=>{const a=ae;return p(),b(u(ce),{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=_=>t.value=_),stretch:"",block:!1},{default:l(()=>[n(a,{label:"表单权限",name:"formPermissions"},{default:l(()=>[h(" 待添加... ")]),_:1}),n(a,{label:"操作权限",name:"operationPermissions"},{default:l(()=>[h(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),go=["id"],xo=$({__name:"index",setup(r,{expose:o}){const e={start:yo,approval:ho,cc:bo};let t=N({id:"",pid:"",type:"",name:"",child:null});const s=N(!1),d=N(!1),a=()=>{d.value&&(d.value=!1)};return o({open:y=>{t.value=y,s.value=!0}}),(y,f)=>{const i=le,c=rt,v=dt;return p(),b(v,{modelValue:s.value,"onUpdate:modelValue":f[2]||(f[2]=m=>s.value=m),size:"35%"},{header:l(({titleId:m,titleClass:w})=>[V("span",{id:m,class:j(w)},[q(n(i,{onBlur:a,maxlength:"30",modelValue:u(t).name,"onUpdate:modelValue":f[0]||(f[0]=I=>u(t).name=I)},null,8,["modelValue"]),[[u(ge),a],[D,d.value]]),q(n(c,{icon:"EditPen",onClick:f[1]||(f[1]=I=>d.value=!0)},{default:l(()=>[h(A(u(t).name),1)]),_:1},512),[[D,!d.value]])],10,go)]),default:l(()=>[(p(),b(oe(e[u(t).type]),{node:u(t)},null,8,["node"]))]),_:1},8,["modelValue"])}}});const ko=T(xo,[["__scopeId","data-v-e9c31a05"]]),$o=r=>{const o=()=>{let i=`node-${Math.random().toString(36).substring(2,7)}`;const c=(v,m)=>{if(v.id===m)return!0;if(v.child)return c(v.child,m);if("children"in v){const w=v;if(w.children&&w.children.length>0)return w.children.some(I=>c(I,m))}return!1};return c(r,i)?o():i},e=i=>{const c=i;c.children.unshift({id:o(),pid:i.id,type:"condition",def:!1,name:`条件${c.children.length+1}`,child:null})},a={condition:e,approval:i=>{const c=i.child,v=o();i.child={id:v,pid:i.id,type:"approval",name:"审批人",child:c,assigneeType:"user",users:[],roles:[],leader:1,method:"sequential",choice:!1,self:!1,nobody:"reject"},c&&(c.pid=v)},cc:i=>{const c=i.child,v=o();i.child={id:v,pid:i.id,type:"cc",name:"抄送人",child:c,users:[]},c&&(c.pid=v)},exclusive:i=>{const c=i.child,v=o(),m={id:v,pid:i.id,type:"exclusive",name:"独占网关",child:c,children:[]};if(i.child=m,c&&(c.pid=v),e(i.child),e(i.child),m.children.length>0){const w=m.children[m.children.length-1];w.def=!0,w.name="默认条件"}}},_=(i,c)=>{const v=a[i];v&&v(c)},y=i=>{f(r,i)},f=(i,c)=>{var v;if(i.id===c.pid)if("children"in i&&((v=i.child)==null?void 0:v.id)!==c.id){const m=i,w=m.children.findIndex(I=>I.id===c.id);w!==-1&&(m.children.length<=2?y(m):m.children.splice(w,1))}else c.child&&c.child.pid&&(c.child.pid=i.id),i.child=c.child;else if(i.child&&f(i.child,c),"children"in i){const m=i;m.children&&m.children.length>0&&m.children.forEach(w=>{f(w,c)})}};return{addNode:_,delNode:y}},Vo={class:"designer-container"},wo={class:"zoom"},Co={class:"node-container"},Eo=$({name:"flowDesign"}),No=$({...Eo,setup(r){ve(f=>({dd50d9ae:s.value}));const o=N(),e=ne({id:"root",pid:null,type:"start",name:"发起人",child:{id:"end",pid:"root",type:"end",name:"结束",child:null}}),t=N(100),s=L(()=>t.value/100),d=f=>{var i;(i=o.value)==null||i.open(f)},{addNode:a,delNode:_}=$o(e);Me("nodeHooks",{readOnly:!1,addNode:a,delNode:_,openPenal:d});const y=f=>{f.shiftKey&&(f.deltaY>0?t.value>50&&(t.value-=10):t.value<170&&(t.value+=10))};return window.addEventListener("wheel",y),De(()=>{window.removeEventListener("wheel",y)}),(f,i)=>{const c=F;return p(),P("div",Vo,[V("div",wo,[n(c,{icon:u(we),onClick:i[0]||(i[0]=v=>t.value+=10),disabled:t.value>=170,circle:""},null,8,["icon","disabled"]),V("span",null,A(t.value)+"%",1),n(c,{icon:u(ht),onClick:i[1]||(i[1]=v=>t.value-=10),circle:"",disabled:t.value<=50},null,8,["icon","disabled"])]),V("div",Co,[n(Te,{node:e},null,8,["node"])]),n(ko,{ref_key:"nodePenalRef",ref:o},null,512)])}}});const Po=T(No,[["__scopeId","data-v-561de022"]]),Io=$({__name:"App",setup(r){return(o,e)=>{const t=it;return p(),b(t,{namespace:"el",locale:u(ut)},{default:l(()=>[n(Po)]),_:1},8,["locale"])}}});const Q=[{id:1,name:"张三",username:"admin",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:2,name:"李四",username:"lisi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:3,name:"王五",username:"wangwu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:4,name:"赵六",username:"zhaoliu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:5,name:"孙七",username:"sunqi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:6,name:"周八",username:"zhouba",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:7,name:"吴九",username:"wujui",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:8,name:"郑十",username:"zhengshi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"}],To=[{url:"/api/user/info",method:"get",response:r=>{const o=r.query.username;return{code:200,success:!0,message:"操作成功",data:Q.find(e=>e.username===o)}}},{url:"/api/user/list",method:"post",response:r=>{const o=r.body.userIds;return{code:200,success:!0,message:"操作成功",data:Array.isArray(o)?Q.filter(e=>o.includes(e.username)):Q}}}],Ao=[...To],So=[...Ao];function Uo(){yt(So)}const zo=He(Io);zo.mount("#app");Uo();
