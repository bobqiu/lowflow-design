var Re=Object.defineProperty;var Me=(r,n,t)=>n in r?Re(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t;var he=(r,n,t)=>(Me(r,typeof n!="symbol"?n+"":n,t),t);import{E as w,d as C,o as _,c as P,O as e,R as s,u as d,a as y,am as oe,an as ne,ao as be,i as R,z as le,a0 as Q,_ as L,S as V,V as f,W as T,T as se,X as U,$ as G,F as W,n as De,w as J,G as Le,P as O,ah as ye,L as M,ad as je,J as ae,h as qe,e as He,A as ge,D as Ge,I as Ke,ap as We}from"./@vue-f145ebf9.js";import{E as Je,a as j,b as D,u as de,c as te,d as xe,C as Ve,e as re,f as z,g as Xe,h as Ye,i as Ze,j as $e,k as Qe,l as et,m as tt,n as ot,w as we,o as nt,p as lt,q as st,r as at,s as ke,t as dt,v as rt,x as it,y as Ee,z as ie,A as ut,B as ct,D as _t,F as pt,G as mt,H as ft}from"./element-plus-85b67eaa.js";import{p as ue,k as Ce,m as Ne,n as Pe,o as vt,a as Ae,r as ht,t as bt,u as yt,x as gt,c as xt,y as Vt,z as Ie}from"./@element-plus-ef6d10d8.js";import{h as X,j as ce}from"./@vueuse-caf007e4.js";import{a as $t}from"./axios-21b846bc.js";import{c as wt}from"./vite-plugin-mock-a6c9e661.js";import"./lodash-es-90b76008.js";import"./async-validator-dee29e8b.js";import"./@sxzz-c75af06c.js";import"./@ctrl-f8748455.js";import"./mockjs-26f03dd7.js";import"./dayjs-725317a4.js";import"./path-to-regexp-31db6522.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(l){if(l.ep)return;l.ep=!0;const i=t(l);fetch(l.href,i)}})();const _e=r=>(oe("data-v-e5f31a23"),r=r(),ne(),r),kt={class:"add-but"},Et={class:"node-select"},Ct=_e(()=>y("span",null,"审批人",-1)),Nt=_e(()=>y("span",null,"抄送人",-1)),Pt=_e(()=>y("span",null,"互斥分支",-1)),At=w({__name:"index",emits:["addNode"],setup(r,{emit:n}){const t=C(),o=()=>{var a;n("addNode","approval"),(a=t.value)==null||a.hide()},l=()=>{var a;n("addNode","cc"),(a=t.value)==null||a.hide()},i=()=>{var a;n("addNode","exclusive"),(a=t.value)==null||a.hide()};return(a,p)=>{const $=j,b=D,u=Je;return _(),P("div",kt,[e(u,{placement:"bottom-start",ref_key:"nodePopoverRef",ref:t,trigger:"click",title:"添加节点",width:235},{reference:s(()=>[e(b,{icon:d(ue),type:"primary",style:{"z-index":"1"},circle:""},null,8,["icon"])]),default:s(()=>[y("div",Et,[y("div",{onClick:o},[e($,{color:"#ff943e"},{default:s(()=>[e(d(Ce))]),_:1}),Ct]),y("div",{onClick:l},[e($,{color:"#3296fa"},{default:s(()=>[e(d(Ne))]),_:1}),Nt]),y("div",{onClick:i},[e($,null,{default:s(()=>[e(d(Pe))]),_:1}),Pt])])]),_:1},512)])}}});const I=(r,n)=>{const t=r.__vccOpts||r;for(const[o,l]of n)t[o]=l;return t},Ue=I(At,[["__scopeId","data-v-e5f31a23"]]),It={class:"node-box"},Ut={class:"head"},Tt={key:2},St=w({__name:"index",props:{icon:{},node:{},color:{},readOnly:{type:Boolean,default:!1},close:{type:Boolean,default:!0},arrow:{type:Boolean,default:!0}},emits:["update:node"],setup(r,{emit:n}){const t=r;be(E=>({"491d81de":b.value,"21b9cac8":$.value,"0d2f2c80":E.color}));const o={list:ht,stamp:Ce,share:Pe,promotion:Ne},{node:l}=X(t,n),i=C(!1),a=C(),p=de(),$=R(()=>te[p.value||"default"]+205+"px"),b=R(()=>te[p.value||"default"]+60+"px"),{addNode:u,delNode:c,openPenal:v}=le("nodeHooks"),h=()=>{t.readOnly||v(l.value)},k=()=>{t.readOnly||(i.value=!0,De(()=>{var E;(E=a.value)==null||E.focus()}))},A=()=>{i.value&&(i.value=!1)};return(E,N)=>{const x=j,g=z,m=D,B=Xe,H=xe;return _(),P("div",It,[e(H,{shadow:"always",onClick:N[4]||(N[4]=F=>h()),class:"node"},{header:s(()=>[y("div",Ut,[i.value?(_(),P("div",{key:0,onClick:N[1]||(N[1]=Q(()=>{},["stop"]))},[L(e(d(re),{ref_key:"inputRef",ref:a,onBlur:A,maxlength:"30",modelValue:d(l).name,"onUpdate:modelValue":N[0]||(N[0]=F=>d(l).name=F)},null,8,["modelValue"]),[[d(Ve),A]])])):(_(),V(g,{key:1,tag:"b",truncated:"",onClick:Q(k,["stop"])},{default:s(()=>[f(T(d(l).name)+" ",1),e(x,null,{default:s(()=>[e(d(vt))]),_:1})]),_:1},8,["onClick"])),E.icon?(_(),P("span",Tt,[e(x,{size:30,color:"node-icon"},{default:s(()=>[(_(),V(se(o[E.icon.toLowerCase()])))]),_:1})])):U("",!0)])]),default:s(()=>[y("div",{onClick:N[3]||(N[3]=Q(()=>{},["stop"]))},[e(B,{title:"您确定要删除该节点吗？",width:"200","hide-after":0,placement:"right-start",onConfirm:N[2]||(N[2]=F=>d(c)(d(l)))},{reference:s(()=>[L(e(m,{class:"node-close",plain:"",circle:"",icon:d(Ae),size:"small",type:"danger"},null,8,["icon"]),[[G,E.close&&!E.readOnly]])]),_:1})]),W(E.$slots,"default",{},void 0,!0)]),_:3}),e(Ue,{onAddNode:N[5]||(N[5]=F=>d(u)(F,d(l)))})])}}});const Y=I(St,[["__scopeId","data-v-315ac0a7"]]),zt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=C("");return J(()=>{t.value=n.node.name}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[f(T(t.value||o.node.name),1)]),_:1})}}}),Bt={class:"start-box"},Ft=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),P("div",Bt,[e(Y,{icon:"List",arrow:!1,close:!1,color:"#8c7cf3",node:n.node},{default:s(()=>[e(zt,{node:n.node},null,8,["node"])]),_:1},8,["node"])]))}});const Ot=I(Ft,[["__scopeId","data-v-0a059602"]]),Rt={baseURL:"/api",timeout:8e3};class Mt{constructor(n){he(this,"service");this.service=$t.create(n),this.service.interceptors.request.use(t=>(t.headers.Authorization="Bearer 87779e5a-3342-4df6-865d-d8828800d6fb",t),t=>Promise.reject(t)),this.service.interceptors.response.use(t=>{const{data:o}=t;return o},t=>{const{response:o,message:l}=t,i=o==null?void 0:o.data,a=i?i.message:l;return Ye.error(a||"未知错误"),Promise.reject((o==null?void 0:o.data)||t)})}get(n,t,o={}){return this.service.get(n,{params:t,...o})}post(n,t){return this.service.post(n,t)}put(n,t){return this.service.put(n,t)}delete(n,t){return this.service.delete(n,t)}patch(n,t){return this.service.patch(n,t)}head(n){return this.service.head(n)}options(n){return this.service.options(n)}request(n){return this.service.request(n)}download(n,t){return this.service.post(n,t,{responseType:"blob"})}}const Te=new Mt(Rt),Dt=r=>Te.get("/user/info",{username:r}),K=r=>{const n=r?{userIds:r}:{};return Te.post("/user/list",n)},Lt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=C("");return J(()=>{const o=n.node;o.assigneeType==="choice"?t.value=`发起人自选（${o.choice?"多选":"单选"}）`:o.assigneeType==="self"?t.value="发起人自己":o.assigneeType==="leader"?t.value=o.leader===1?"直属上级":`${o.leader}级上级`:o.assigneeType==="formUser"?t.value="表单内人员":o.assigneeType==="user"?o.users.length>0?K(o.users).then(l=>{l.success&&(t.value=l.data.map(i=>i.name).join("、"))}):t.value="未指定人员":o.assigneeType==="role"?o.roles.length>0||(t.value="未指定角色"):t.value=n.node.name}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[f(T(t.value||o.node.name),1)]),_:1})}}}),jt=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),V(Y,{icon:"Stamp",color:"linear-gradient(89.96deg, #FA6F32 .05%, #FB9337 79.83%)",node:n.node},{default:s(()=>[e(Lt,{node:n.node},null,8,["node"])]),_:1},8,["node"]))}}),qt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=C("");return J(()=>{const o=n.node;o.users.length>0?K(o.users).then(l=>{l.success&&(t.value=l.data.map(i=>i.name).join("、"))}):t.value="未指定人员"}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[f(T(t.value||o.node.name),1)]),_:1})}}}),Ht=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),V(Y,Le({icon:"Promotion"},n.$attrs,{color:"#3296FA",node:n.node}),{default:s(()=>[e(qt,{node:n.node},null,8,["node"])]),_:1},16,["node"]))}}),Gt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=C(e("span",null,null));return J(()=>{if(n.node.def)return t.value=e("span",null,[f("不满足条件时，进入默认条件")]);n.node.conditions.conditions.length>0||n.node.conditions.groups.length>0?t.value=e("span",null,[f("已设置（"),n.node.conditions.conditions.length+n.node.conditions.groups.length,f("）个条件")]):t.value=e("span",null,[f("未设置条件")])}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[e(d(t))]),_:1})}}}),Kt={class:"condition-box"},Wt=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),P("div",Kt,[e(Y,{icon:"Share",readOnly:n.node.def,node:n.node},{default:s(()=>[e(Gt,{node:n.node},null,8,["node"])]),_:1},8,["readOnly","node"])]))}});const Jt=I(Wt,[["__scopeId","data-v-d12a68c4"]]),Z=r=>(oe("data-v-1ca7350c"),r=r(),ne(),r),Xt={class:"branch-node"},Yt={class:"add-branch"},Zt=Z(()=>y("div",{class:M("top-right-border")},null,-1)),Qt=Z(()=>y("div",{class:M("bottom-right-border")},null,-1)),eo=Z(()=>y("div",{class:M("top-left-border")},null,-1)),to=Z(()=>y("div",{class:M("bottom-left-border")},null,-1)),oo=w({__name:"index",props:{node:{}},setup(r){const{addNode:n}=le("nodeHooks");return(t,o)=>(_(),P(O,null,[y("div",Xt,[y("div",Yt,[W(t.$slots,"default",{},void 0,!0)]),(_(!0),P(O,null,ye(t.node.children,(l,i)=>(_(),P("div",{key:l.id,class:"col-box"},[t.node.children.length===i+1?(_(),P(O,{key:0},[Zt,Qt],64)):U("",!0),i===0?(_(),P(O,{key:1},[eo,to],64)):U("",!0),e(Se,{node:l},null,8,["node"])]))),128))]),e(Ue,{onAddNode:o[0]||(o[0]=l=>d(n)(l,t.node)),class:"branch-but"})],64))}});const no=I(oo,[["__scopeId","data-v-1ca7350c"]]),lo=w({__name:"index",props:{node:{}},setup(r){const{addNode:n}=le("nodeHooks");return(t,o)=>{const l=D;return _(),V(no,{node:t.node},{default:s(()=>[e(l,{type:"primary",onClick:o[0]||(o[0]=i=>d(n)("condition",t.node)),plain:"",round:""},{default:s(()=>[f("添加条件")]),_:1})]),_:1},8,["node"])}}});const so={},ao={class:"node-box"};function ro(r,n){const t=z;return _(),P("div",ao,[e(t,{class:"end-node"},{default:s(()=>[f(" 结束 ")]),_:1})])}const io=I(so,[["render",ro],["__scopeId","data-v-74763bb4"]]),uo=w({name:"NodeTree"}),co=w({...uo,props:{node:{}},setup(r){const n={start:Ot,approval:jt,cc:Ht,condition:Jt,exclusive:lo,end:io};return(t,o)=>{const l=je("NodeTree");return _(),P(O,null,[W(t.$slots,"default",{},void 0,!0),(_(),V(se(n[t.node.type]),{node:t.node},null,8,["node"])),t.node.child?(_(),V(l,{key:0,node:t.node.child},null,8,["node"])):U("",!0)],64)}}});const Se=I(co,[["__scopeId","data-v-1288ab88"]]),_o={class:"flex-center",style:{gap:"4px","grid-gap":"4px"}},po=w({__name:"UserTag",props:{username:{},type:{default:"info"},closable:{type:Boolean,default:!1}},emits:["close"],setup(r,{emit:n}){const t=r;let o=ae({username:void 0,avatar:void 0,name:void 0});qe(()=>{if(!t.username)throw new Error("username is required");Dt(t.username).then(p=>{p.success&&(o.username=p.data.username,o.avatar=p.data.avatar,o.name=p.data.name)})}),R(()=>{const p="/api";return p.startsWith("http")?p:window.location.origin+p});const l=de(),i=R(()=>te[l.value||"default"]-12),a=()=>{n("close",t.username)};return(p,$)=>{const b=$e,u=Ze;return _(),V(u,{round:"",closable:t.closable,type:p.type,effect:"light",onClose:a},{default:s(()=>[y("div",_o,[e(b,{size:i.value,src:d(o).avatar},{default:s(()=>[f(T((d(o).name||p.username).charAt(0)),1)]),_:1},8,["size","src"]),y("span",null,T(d(o).name||p.username),1)])]),_:1},8,["closable","type"])}}});const pe=I(po,[["__scopeId","data-v-11e894be"]]),mo={class:"flex flex-1 flex-items-center flex-justify-between"},fo={class:"flex-center"},vo=w({__name:"UserPicker",props:{modelValue:{},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{expose:n,emit:t}){const o=r,l={label:"name",children:"children",isLeaf:"leaf",class:x=>u(x)},i=ce(o,"modelValue",t),a=C([]),p=C([]),$=C(),b=C([]),u=x=>a.value.find(m=>m.id===x.id)?"is-active":"",c=x=>{if(x.type==="user")if(o.multiple){const g=a.value.findIndex(m=>m.id===x.id);g===-1?(a.value.push(x),a.value.sort((m,B)=>m.id.localeCompare(B.id))):a.value.splice(g,1)}else{const g=a.value.findIndex(m=>m.id===x.id);g===-1?a.value=[x]:a.value.splice(g,1)}},v=C(!1),h=ae({name:null});He(()=>h.name,x=>{var g;(g=$.value)==null||g.filter(x)});const k=(x,g)=>x?g.name.includes(x):!0,A=()=>{v.value=!0},E=()=>{K().then(g=>{g.success&&(p.value=g.data.map(m=>({id:m.username,name:m.name,type:"user",leaf:!0,avatar:m.avatar})))});let x=[];Array.isArray(i.value)?x.push(...i.value):i.value&&x.push(i.value),x.length>0?K(x).then(g=>{g.success&&(a.value=g.data.map(m=>({id:m.username,name:m.name,avatar:m.avatar,type:"user",leaf:!0})),a.value.sort((m,B)=>m.id.localeCompare(B.id)))}):a.value=[]},N=()=>{o.multiple?i.value=a.value.map(x=>x.id):a.value.length>0?i.value=a.value[0].id:i.value=null,v.value=!1};return n({open:A}),(x,g)=>{const m=re,B=$e,H=j,F=et,Be=tt,Fe=xe,ve=D,Oe=Qe;return _(),V(Oe,{modelValue:v.value,"onUpdate:modelValue":g[2]||(g[2]=S=>v.value=S),onOpen:E,"align-center":"",draggable:"",title:"选择用户",width:"30%"},{footer:s(()=>[e(ve,{onClick:g[1]||(g[1]=S=>v.value=!1)},{default:s(()=>[f("取消")]),_:1}),e(ve,{type:"primary",onClick:N},{default:s(()=>[f("确认")]),_:1})]),default:s(()=>[e(Fe,{shadow:"never",class:"org-card"},{header:s(()=>[e(m,{modelValue:h.name,"onUpdate:modelValue":g[0]||(g[0]=S=>h.name=S),placeholder:"输入关键字进行查询",style:{width:"100%"},"suffix-icon":"search",clearable:""},null,8,["modelValue"])]),default:s(()=>[e(Be,{tag:"div",class:"org-tree"},{default:s(()=>[e(F,{ref_key:"orgTreeRef",ref:$,"node-key":"id",data:p.value,"default-expanded-keys":b.value,props:l,"filter-node-method":k,onNodeClick:c},{default:s(({data:S})=>[y("div",mo,[y("div",fo,[S.type==="user"?(_(),V(B,{key:0,size:25,src:S.avatar},{default:s(()=>[f(T(S.name.charAt(0)),1)]),_:2},1032,["src"])):(_(),V(H,{key:1,size:16},{default:s(()=>[e(d(bt))]),_:1})),f("  "+T(S.name),1)]),e(H,{class:"is-selected"},{default:s(()=>[e(d(yt))]),_:1})])]),_:1},8,["data","default-expanded-keys"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const me=I(vo,[["__scopeId","data-v-54f06cf8"]]),ho={class:"user-wrapper"},bo=w({__name:"UserSelector",props:{modelValue:{},placeholder:{default:"请选择用户"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},style:{}},emits:["update:modelValue"],setup(r,{emit:n}){const t=r,o=ce(t,"modelValue",n),l=R(()=>o.value?Array.isArray(o.value)?o.value:[o.value]:[]),i=C(),a=ot(),p=de(),$=R(()=>a.value||t.disabled),b=()=>{var c;(c=i.value)==null||c.open()},u=c=>{o.value&&(t.multiple&&Array.isArray(o.value)?o.value.splice(o.value.indexOf(c),1):o.value=null)};return(c,v)=>{const h=j,k=D,A=z;return _(),P(O,null,[e(me,{ref_key:"userPickerRef",ref:i,multiple:c.multiple,modelValue:d(o),"onUpdate:modelValue":v[0]||(v[0]=E=>ge(o)?o.value=E:null)},null,8,["multiple","modelValue"]),y("div",ho,[e(k,{class:"user-but-item",size:d(p),disabled:$.value,onClick:b,circle:""},{default:s(()=>[e(h,null,{default:s(()=>[e(d(gt))]),_:1})]),_:1},8,["size","disabled"]),(_(!0),P(O,null,ye(l.value,E=>(_(),V(pe,{closable:!$.value,key:E,username:E,onClose:u},null,8,["closable","username"]))),128)),L(e(A,{class:"placeholder"},{default:s(()=>[f(T(c.placeholder),1)]),_:1},512),[[G,!d(o)||d(o).length===0]])])],64)}}});const yo=I(bo,[["__scopeId","data-v-478c5cf7"]]);we(pe);we(me);const ze=nt(yo,{userTag:pe,userPicker:me}),go=w({__name:"index",props:{block:{type:Boolean,default:!0},modelValue:{}},emits:["update:modelValue"],setup(r,{emit:n}){const o=ce(r,"modelValue",n);return(l,i)=>{const a=lt;return _(),V(a,{modelValue:d(o),"onUpdate:modelValue":i[0]||(i[0]=p=>ge(o)?o.value=p:null),class:M(["el-segmented",{"is-block":l.block}])},{default:s(()=>[W(l.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue","class"])}}});const fe=I(go,[["__scopeId","data-v-6406405a"]]),q=r=>(oe("data-v-05119c57"),r=r(),ne(),r),xo={class:"flow-opt-item"},Vo={class:"flow-opt-item__content"},$o=q(()=>y("div",{class:"flow-opt-item__second"}," 同意描述、同意描述、同意描述、同意描述、同意描述、同意描述 ",-1)),wo={class:"flow-opt-item"},ko={class:"flow-opt-item__content"},Eo=q(()=>y("div",{class:"flow-opt-item__second"}," 拒绝描述、拒绝描述、拒绝描述、拒绝描述、拒绝描述、拒绝描述 ",-1)),Co={class:"flow-opt-item"},No={class:"flow-opt-item__content"},Po=q(()=>y("div",{class:"flow-opt-item__second"}," 转办描述、转办描述、转办描述、转办描述、转办描述、转办描述 ",-1)),Ao={class:"flow-opt-item"},Io={class:"flow-opt-item__content"},Uo=q(()=>y("div",{class:"flow-opt-item__second"}," 加签描述、加签描述、加签描述、加签描述、加签描述、加签描述 ",-1)),To={class:"flow-opt-item"},So={class:"flow-opt-item__content"},zo=q(()=>y("div",{class:"flow-opt-item__second"}," 减签描述、减签描述、减签描述、减签描述、减签描述、减签描述 ",-1)),Bo=w({__name:"ApprovalAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:n}){const t=r,o=C("properties"),{node:l}=X(t,n);return(i,a)=>{const p=st,$=at,b=ke,u=ze,c=dt,v=z,h=rt,k=it,A=Ee,E=ie,N=j,x=ut,g=ct;return _(),V(d(fe),{modelValue:o.value,"onUpdate:modelValue":a[11]||(a[11]=m=>o.value=m),stretch:"",block:!1},{default:s(()=>[e(E,{label:"设置审批人",name:"properties"},{default:s(()=>[e(A,{"label-position":"top","label-width":"90px"},{default:s(()=>[e(b,{prop:"assigneeType",label:"审批对象"},{default:s(()=>[e($,{modelValue:d(l).assigneeType,"onUpdate:modelValue":a[0]||(a[0]=m=>d(l).assigneeType=m)},{default:s(()=>[e(p,{label:"user"},{default:s(()=>[f("指定人员")]),_:1}),e(p,{label:"role"},{default:s(()=>[f("指定角色")]),_:1}),e(p,{label:"choice"},{default:s(()=>[f("发起人自选")]),_:1}),e(p,{label:"self"},{default:s(()=>[f("发起人自己")]),_:1}),e(p,{label:"leader"},{default:s(()=>[f("多级上级")]),_:1}),e(p,{label:"formUser"},{default:s(()=>[f("表单内人员")]),_:1}),e(p,{label:"formRole"},{default:s(()=>[f("表单内角色")]),_:1})]),_:1},8,["modelValue"])]),_:1}),d(l).assigneeType==="user"?(_(),V(b,{key:0,prop:"users",label:"指定人员"},{default:s(()=>[e(u,{multiple:"",placeholder:"请选择人员",modelValue:d(l).users,"onUpdate:modelValue":a[1]||(a[1]=m=>d(l).users=m)},null,8,["modelValue"])]),_:1})):U("",!0),d(l).assigneeType==="choice"?(_(),V(b,{key:1,prop:"selfSelect",label:"发起人自选择"},{default:s(()=>[e($,{modelValue:d(l).choice,"onUpdate:modelValue":a[2]||(a[2]=m=>d(l).choice=m)},{default:s(()=>[e(c,{label:!1},{default:s(()=>[f("单选")]),_:1}),e(c,{label:!0},{default:s(()=>[f("多选")]),_:1})]),_:1},8,["modelValue"])]),_:1})):U("",!0),d(l).assigneeType==="self"?(_(),V(b,{key:2,prop:"self",label:"发起人自己"},{default:s(()=>[e(v,null,{default:s(()=>[f(" 发起人自己作为审批人进行审批 ")]),_:1})]),_:1})):U("",!0),d(l).assigneeType==="leader"?(_(),V(b,{key:3,prop:"leader",label:"直属上级"},{default:s(()=>[e(k,{modelValue:d(l).leader,"onUpdate:modelValue":a[3]||(a[3]=m=>d(l).leader=m),placeholder:"请选择直属上级"},{default:s(()=>[e(h,{label:"直属上级",value:1}),e(h,{label:"二级上级",value:2}),e(h,{label:"三级上级",value:3}),e(h,{label:"四级上级",value:4}),e(h,{label:"五级上级",value:5}),e(h,{label:"六级上级",value:6}),e(h,{label:"七级上级",value:7}),e(h,{label:"八级上级",value:8}),e(h,{label:"九级上级",value:9}),e(h,{label:"十级上级",value:10}),e(h,{label:"十一级上级",value:11})]),_:1},8,["modelValue"])]),_:1})):U("",!0),d(l).assigneeType==="role"?(_(),V(b,{key:4,prop:"roles",label:"指定角色"},{default:s(()=>[f(" 待添加... ")]),_:1})):U("",!0),d(l).assigneeType==="formUser"?(_(),V(b,{key:5,prop:"formUser",label:"表单内人员"},{default:s(()=>[f(" 待添加... ")]),_:1})):U("",!0),d(l).assigneeType==="formRole"?(_(),V(b,{key:6,prop:"formRole",label:"表单内角色"},{default:s(()=>[f(" 待添加... ")]),_:1})):U("",!0),e(b,{prop:"method",label:"多人审批方式"},{default:s(()=>[e($,{class:"flex-column",modelValue:d(l).multi,"onUpdate:modelValue":a[4]||(a[4]=m=>d(l).multi=m)},{default:s(()=>[e(p,{label:"sequential"},{default:s(()=>[f("依次审批")]),_:1}),e(p,{label:"joint"},{default:s(()=>[f("会签（需要所有审批人都通过才可通过）")]),_:1}),e(p,{label:"single"},{default:s(()=>[f("或签（其中一名审批人通过或驳回即可）")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(b,{prop:"nobody",label:"审批人为空"},{default:s(()=>[e($,{modelValue:d(l).nobody,"onUpdate:modelValue":a[5]||(a[5]=m=>d(l).nobody=m)},{default:s(()=>[e(p,{label:"pass"},{default:s(()=>[f("自动通过")]),_:1}),e(p,{label:"reject"},{default:s(()=>[f("自动驳回")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(E,{label:"表单权限",name:"formPermissions"},{default:s(()=>[f(" 待添加... ")]),_:1}),e(E,{label:"操作权限",name:"operationPermissions"},{default:s(()=>[y("div",xo,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(xt))]),_:1}),y("div",Vo,[e(v,{tag:"b"},{default:s(()=>[f(" 同意 ")]),_:1}),$o]),e(x,{modelValue:d(l).operations.complete,"onUpdate:modelValue":a[6]||(a[6]=m=>d(l).operations.complete=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",wo,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(Ae))]),_:1}),y("div",ko,[e(v,{tag:"b"},{default:s(()=>[f(" 拒绝 ")]),_:1}),Eo]),e(x,{modelValue:d(l).operations.refuse,"onUpdate:modelValue":a[7]||(a[7]=m=>d(l).operations.refuse=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",Co,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(Vt))]),_:1}),y("div",No,[e(v,{tag:"b"},{default:s(()=>[f(" 转办 ")]),_:1}),Po]),e(x,{modelValue:d(l).operations.transfer,"onUpdate:modelValue":a[8]||(a[8]=m=>d(l).operations.transfer=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",Ao,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(ue))]),_:1}),y("div",Io,[e(v,{tag:"b"},{default:s(()=>[f(" 加签 ")]),_:1}),Uo]),e(x,{modelValue:d(l).operations.addMulti,"onUpdate:modelValue":a[9]||(a[9]=m=>d(l).operations.addMulti=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",To,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(Ie))]),_:1}),y("div",So,[e(v,{tag:"b"},{default:s(()=>[f(" 减签 ")]),_:1}),zo]),e(x,{modelValue:d(l).operations.minusMulti,"onUpdate:modelValue":a[10]||(a[10]=m=>d(l).operations.minusMulti=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g)]),_:1})]),_:1},8,["modelValue"])}}});const Fo=I(Bo,[["__scopeId","data-v-05119c57"]]),Oo=w({__name:"CcAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:n}){const t=r,o=C("properties"),{node:l}=X(t,n);return(i,a)=>{const p=ze,$=ke,b=Ee,u=ie;return _(),V(d(fe),{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=c=>o.value=c),stretch:"",block:!1},{default:s(()=>[e(u,{label:"设置抄送人",name:"properties"},{default:s(()=>[e(b,{"label-position":"top","label-width":"90px"},{default:s(()=>[e($,{prop:"users",label:"抄送人"},{default:s(()=>[e(p,{multiple:"",placeholder:"请选择人员",modelValue:d(l).users,"onUpdate:modelValue":a[0]||(a[0]=c=>d(l).users=c)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{label:"表单权限",name:"formPermissions"},{default:s(()=>[f(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),Ro=w({__name:"StartAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:n}){const t=r,o=C("formPermissions");return X(t,n),(l,i)=>{const a=ie;return _(),V(d(fe),{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=p=>o.value=p),stretch:"",block:!1},{default:s(()=>[e(a,{label:"表单权限",name:"formPermissions"},{default:s(()=>[f(" 待添加... ")]),_:1}),e(a,{label:"操作权限",name:"operationPermissions"},{default:s(()=>[f(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),Mo=["id"],Do=w({__name:"index",setup(r,{expose:n}){const t={start:Ro,approval:Fo,cc:Oo};let o=C({id:"",pid:"",type:"",name:"",child:null});const l=C(!1),i=C(!1),a=()=>{i.value&&(i.value=!1)};return n({open:$=>{o.value=$,l.value=!0}}),($,b)=>{const u=re,c=pt,v=_t;return _(),V(v,{modelValue:l.value,"onUpdate:modelValue":b[2]||(b[2]=h=>l.value=h),size:"35%"},{header:s(({titleId:h,titleClass:k})=>[y("span",{id:h,class:M(k)},[L(e(u,{onBlur:a,maxlength:"30",modelValue:d(o).name,"onUpdate:modelValue":b[0]||(b[0]=A=>d(o).name=A)},null,8,["modelValue"]),[[d(Ve),a],[G,i.value]]),L(e(c,{icon:"EditPen",onClick:b[1]||(b[1]=A=>i.value=!0)},{default:s(()=>[f(T(d(o).name),1)]),_:1},512),[[G,!i.value]])],10,Mo)]),default:s(()=>[(_(),V(se(t[d(o).type]),{node:d(o)},null,8,["node"]))]),_:1},8,["modelValue"])}}});const Lo=I(Do,[["__scopeId","data-v-e9c31a05"]]),jo=r=>{const n=()=>{let u=`node-${Math.random().toString(36).substring(2,7)}`;const c=(v,h)=>{if(v.id===h)return!0;if(v.child)return c(v.child,h);if("children"in v){const k=v;if(k.children&&k.children.length>0)return k.children.some(A=>c(A,h))}return!1};return c(r,u)?n():u},t=u=>{const c=u;c.children.unshift({id:n(),pid:u.id,type:"condition",def:!1,name:`条件${c.children.length+1}`,conditions:{logicalOperator:"and",conditions:[],groups:[]},child:null})},a={condition:t,approval:u=>{const c=u.child,v=n();u.child={id:v,pid:u.id,type:"approval",name:"审批人",child:c,assigneeType:"user",users:[],roles:[],leader:1,multi:"sequential",choice:!1,self:!1,nobody:"reject",operations:{complete:!0,refuse:!0,transfer:!1,addMulti:!1,minusMulti:!1}},c&&(c.pid=v)},cc:u=>{const c=u.child,v=n();u.child={id:v,pid:u.id,type:"cc",name:"抄送人",child:c,users:[]},c&&(c.pid=v)},exclusive:u=>{const c=u.child,v=n(),h={id:v,pid:u.id,type:"exclusive",name:"独占网关",child:c,children:[]};if(u.child=h,c&&(c.pid=v),t(u.child),t(u.child),h.children.length>0){const k=h.children[h.children.length-1];k.def=!0,k.name="默认条件"}}},p=(u,c)=>{const v=a[u];v&&v(c)},$=u=>{b(r,u)},b=(u,c)=>{var v;if(u.id===c.pid)if("children"in u&&((v=u.child)==null?void 0:v.id)!==c.id){const h=u,k=h.children.findIndex(A=>A.id===c.id);k!==-1&&(h.children.length<=2?$(h):h.children.splice(k,1))}else c.child&&c.child.pid&&(c.child.pid=u.id),u.child=c.child;else if(u.child&&b(u.child,c),"children"in u){const h=u;h.children&&h.children.length>0&&h.children.forEach(k=>{b(k,c)})}};return{addNode:p,delNode:$}},qo={class:"designer-container"},Ho={class:"zoom"},Go={class:"node-container"},Ko=w({name:"flowDesign"}),Wo=w({...Ko,setup(r){be(b=>({dd50d9ae:l.value}));const n=C(),t=ae({id:"root",pid:null,type:"start",name:"发起人",child:{id:"end",pid:"root",type:"end",name:"结束",child:null}}),o=C(100),l=R(()=>o.value/100),i=b=>{var u;(u=n.value)==null||u.open(b)},{addNode:a,delNode:p}=jo(t);Ge("nodeHooks",{readOnly:!1,addNode:a,delNode:p,openPenal:i});const $=b=>{b.shiftKey&&(b.deltaY>0?o.value>50&&(o.value-=10):o.value<170&&(o.value+=10))};return window.addEventListener("wheel",$),Ke(()=>{window.removeEventListener("wheel",$)}),(b,u)=>{const c=D;return _(),P("div",qo,[y("div",Ho,[e(c,{icon:d(ue),onClick:u[0]||(u[0]=v=>o.value+=10),disabled:o.value>=170,circle:""},null,8,["icon","disabled"]),y("span",null,T(o.value)+"%",1),e(c,{icon:d(Ie),onClick:u[1]||(u[1]=v=>o.value-=10),circle:"",disabled:o.value<=50},null,8,["icon","disabled"])]),y("div",Go,[e(Se,{node:t},null,8,["node"])]),e(Lo,{ref_key:"nodePenalRef",ref:n},null,512)])}}});const Jo=I(Wo,[["__scopeId","data-v-561de022"]]),Xo=w({__name:"App",setup(r){return(n,t)=>{const o=ft;return _(),V(o,{namespace:"el",locale:d(mt)},{default:s(()=>[e(Jo)]),_:1},8,["locale"])}}});const ee=[{id:1,name:"张三",username:"admin",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:2,name:"李四",username:"lisi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:3,name:"王五",username:"wangwu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:4,name:"赵六",username:"zhaoliu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:5,name:"孙七",username:"sunqi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:6,name:"周八",username:"zhouba",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:7,name:"吴九",username:"wujui",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:8,name:"郑十",username:"zhengshi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"}],Yo=[{url:"/api/user/info",method:"get",response:r=>{const n=r.query.username;return{code:200,success:!0,message:"操作成功",data:ee.find(t=>t.username===n)}}},{url:"/api/user/list",method:"post",response:r=>{const n=r.body.userIds;return{code:200,success:!0,message:"操作成功",data:Array.isArray(n)?ee.filter(t=>n.includes(t.username)):ee}}}],Zo=[...Yo],Qo=[...Zo];function en(){wt(Qo)}const tn=We(Xo);tn.mount("#app");en();
