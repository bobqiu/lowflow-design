var Oe=Object.defineProperty;var Me=(i,s,e)=>s in i?Oe(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e;var ge=(i,s,e)=>(Me(i,typeof s!="symbol"?s+"":s,e),e);import{E as C,b as V,o as f,c as T,O as o,R as l,u as d,a as b,am as se,an as le,ao as be,i as O,z as X,a0 as W,_ as D,S as $,V as m,W as A,T as ae,X as P,$ as j,F as Y,L as M,n as De,w as Z,G as Le,P as R,ah as ye,ad as je,J as re,e as qe,d as He,A as we,D as Ge,I as Ke,ap as We}from"./@vue-2e8e7ef1.js";import{E as q,a as L,b as Je,u as de,c as ne,C as $e,d as ie,e as Xe,f as z,g as Ye,h as xe,i as Ze,j as Ve,k as Qe,l as eo,m as oo,n as to,o as no,w as ke,p as so,q as lo,r as ao,s as ro,t as Ee,v as io,x as uo,y as co,z as Ce,A as ue,B as po,D as _o,F as mo,G as fo,H as vo,I as ho}from"./element-plus-01d99e07.js";import{p as ce,k as Ie,m as Ne,n as Te,o as go,r as bo,a as Ue,t as yo,u as wo,x as $o,y as xo,c as Vo,z as ko,A as Ae}from"./@element-plus-f8fe05e0.js";import{h as H,j as pe}from"./@vueuse-d0495bea.js";import{a as Eo}from"./axios-21b846bc.js";import{c as Co}from"./vite-plugin-mock-a6c9e661.js";import"./lodash-es-90b76008.js";import"./async-validator-dee29e8b.js";import"./@sxzz-c75af06c.js";import"./@ctrl-f8748455.js";import"./mockjs-26f03dd7.js";import"./dayjs-725317a4.js";import"./path-to-regexp-31db6522.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();const _e=i=>(se("data-v-e5f31a23"),i=i(),le(),i),Io={class:"add-but"},No={class:"node-select"},To=_e(()=>b("span",null,"审批人",-1)),Uo=_e(()=>b("span",null,"抄送人",-1)),Ao=_e(()=>b("span",null,"互斥分支",-1)),Po=C({__name:"index",emits:["addNode"],setup(i,{emit:s}){const e=V(),t=()=>{var r;s("addNode","approval"),(r=e.value)==null||r.hide()},n=()=>{var r;s("addNode","cc"),(r=e.value)==null||r.hide()},a=()=>{var r;s("addNode","exclusive"),(r=e.value)==null||r.hide()};return(r,h)=>{const k=q,w=L,N=Je;return f(),T("div",Io,[o(N,{placement:"bottom-start",ref_key:"nodePopoverRef",ref:e,trigger:"click",title:"添加节点",width:235},{reference:l(()=>[o(w,{icon:d(ce),type:"primary",style:{"z-index":"1"},circle:""},null,8,["icon"])]),default:l(()=>[b("div",No,[b("div",{onClick:t},[o(k,{color:"#ff943e"},{default:l(()=>[o(d(Ie))]),_:1}),To]),b("div",{onClick:n},[o(k,{color:"#3296fa"},{default:l(()=>[o(d(Ne))]),_:1}),Uo]),b("div",{onClick:a},[o(k,null,{default:l(()=>[o(d(Te))]),_:1}),Ao])])]),_:1},512)])}}});const U=(i,s)=>{const e=i.__vccOpts||i;for(const[t,n]of s)e[t]=n;return e},Pe=U(Po,[["__scopeId","data-v-e5f31a23"]]),So={class:"node-box"},zo={class:"head"},Bo={key:2},Fo=C({__name:"index",props:{icon:{},node:{},color:{},readOnly:{type:Boolean,default:!1},close:{type:Boolean,default:!0},arrow:{type:Boolean,default:!0},errorInfo:{default:()=>({showError:!1,message:""})}},emits:["update:node"],setup(i,{emit:s}){const e=i;be(p=>({f13798a2:w.value,"78d01a3e":k.value,f023673c:p.color}));const t={list:yo,stamp:Ie,share:Te,promotion:Ne},{node:n}=H(e,s),a=V(!1),r=V(),h=de(),k=O(()=>ne[h.value||"default"]+205+"px"),w=O(()=>ne[h.value||"default"]+60+"px"),{addNode:N,delNode:I,openPenal:E}=X("nodeHooks"),x=()=>{e.readOnly||E(n.value)},u=()=>{e.readOnly||(a.value=!0,De(()=>{var p;(p=r.value)==null||p.focus()}))},c=()=>{a.value&&(a.value=!1)};return(p,_)=>{const g=q,y=Xe,v=z,B=L,K=Ye,oe=xe;return f(),T("div",So,[o(oe,{shadow:"always",onClick:_[5]||(_[5]=F=>x()),class:M(["node",{"error-node":e.errorInfo.showError}])},{header:l(()=>[b("div",zo,[a.value?(f(),T("div",{key:0,onClick:_[2]||(_[2]=W(()=>{},["stop"]))},[D(o(d(ie),{ref_key:"inputRef",ref:r,onBlur:c,maxlength:"30",modelValue:d(n).name,"onUpdate:modelValue":_[1]||(_[1]=F=>d(n).name=F)},null,8,["modelValue"]),[[d($e),c]])])):(f(),$(v,{key:1,tag:"b",truncated:"",onClick:W(u,["stop"])},{default:l(()=>[m(A(d(n).name)+" ",1),o(g,null,{default:l(()=>[o(d(go))]),_:1})]),_:1},8,["onClick"])),p.icon?(f(),T("span",Bo,[o(g,{size:30,color:"node-icon"},{default:l(()=>[(f(),$(ae(t[p.icon.toLowerCase()])))]),_:1})])):P("",!0)])]),default:l(()=>[o(y,{placement:"top-start"},{content:l(()=>[m(A(e.errorInfo.message),1)]),default:l(()=>[D(o(g,{class:"warn-icon",size:20},{default:l(()=>[o(d(bo),{onClick:_[0]||(_[0]=W(()=>{},["stop"]))})]),_:1},512),[[j,e.errorInfo.showError]])]),_:1}),b("div",{onClick:_[4]||(_[4]=W(()=>{},["stop"]))},[o(K,{title:"您确定要删除该节点吗？",width:"200","hide-after":0,placement:"right-start",onConfirm:_[3]||(_[3]=F=>d(I)(d(n)))},{reference:l(()=>[D(o(B,{class:"node-close",plain:"",circle:"",icon:d(Ue),size:"small",type:"danger"},null,8,["icon"]),[[j,p.close&&!p.readOnly]])]),_:1})]),Y(p.$slots,"default",{},void 0,!0)]),_:3},8,["class"]),o(Pe,{onAddNode:_[6]||(_[6]=F=>d(N)(F,d(n)))})])}}});const Q=U(Fo,[["__scopeId","data-v-280b57f7"]]),Ro=C({__name:"content",props:{node:{}},setup(i){const s=i,e=V("");return Z(()=>{e.value=s.node.name}),(t,n)=>{const a=z;return f(),$(a,null,{default:l(()=>[m(A(e.value||t.node.name),1)]),_:1})}}}),Oo={class:"start-box"},Mo=C({__name:"index",props:{node:{}},setup(i){return(s,e)=>(f(),T("div",Oo,[o(Q,{icon:"List",arrow:!1,close:!1,color:"#8c7cf3",node:s.node},{default:l(()=>[o(Ro,{node:s.node},null,8,["node"])]),_:1},8,["node"])]))}});const Do=U(Mo,[["__scopeId","data-v-0a059602"]]),Lo={baseURL:"/api",timeout:8e3};class jo{constructor(s){ge(this,"service");this.service=Eo.create(s),this.service.interceptors.request.use(e=>(e.headers.Authorization="Bearer 87779e5a-3342-4df6-865d-d8828800d6fb",e),e=>Promise.reject(e)),this.service.interceptors.response.use(e=>{const{data:t}=e;return t},e=>{const{response:t,message:n}=e,a=t==null?void 0:t.data,r=a?a.message:n;return Ze.error(r||"未知错误"),Promise.reject((t==null?void 0:t.data)||e)})}get(s,e,t={}){return this.service.get(s,{params:e,...t})}post(s,e){return this.service.post(s,e)}put(s,e){return this.service.put(s,e)}delete(s,e){return this.service.delete(s,e)}patch(s,e){return this.service.patch(s,e)}head(s){return this.service.head(s)}options(s){return this.service.options(s)}request(s){return this.service.request(s)}download(s,e){return this.service.post(s,e,{responseType:"blob"})}}const Se=new jo(Lo),qo=i=>Se.get("/user/info",{username:i}),J=i=>{const s=i?{userIds:i}:{};return Se.post("/user/list",s)},Ho=C({__name:"content",props:{node:{}},setup(i){const s=i,e=V("");return Z(()=>{const t=s.node;t.assigneeType==="choice"?e.value=`发起人自选（${t.choice?"多选":"单选"}）`:t.assigneeType==="self"?e.value="发起人自己":t.assigneeType==="leader"?e.value=t.leader===1?"直属上级":`${t.leader}级上级`:t.assigneeType==="formUser"?e.value="表单内人员":t.assigneeType==="formRole"?e.value="表单内角色":t.assigneeType==="user"?t.users.length>0?J(t.users).then(n=>{n.success&&(e.value=n.data.map(a=>a.name).join("、"))}):e.value="未指定人员":t.assigneeType==="role"?t.roles.length>0||(e.value="未指定角色"):e.value=s.node.name}),(t,n)=>{const a=z;return f(),$(a,null,{default:l(()=>[m(A(e.value||t.node.name),1)]),_:1})}}}),Go=C({__name:"index",props:{node:{}},setup(i,{expose:s}){const e=i,t=V({showError:!1,message:""});return s({validate:()=>(t.value={showError:!1,message:""},e.node.assigneeType==="user"?e.node.users.length===0&&(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未指定人员`}):e.node.assigneeType==="role"?e.node.roles.length===0&&(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未指定角色`}):e.node.assigneeType==="formUser"?e.node.formRole||(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未指定表单内人员`}):e.node.assigneeType==="formRole"?e.node.formRole||(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未指定表单内角色`}):e.node.assigneeType==="leader"&&(e.node.leader||(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未指定多级上级`})),t.value)}),(a,r)=>(f(),$(Q,{icon:"Stamp",color:"linear-gradient(89.96deg, #FA6F32 .05%, #FB9337 79.83%)","error-info":t.value,node:a.node},{default:l(()=>[o(Ho,{node:a.node},null,8,["node"])]),_:1},8,["error-info","node"]))}}),Ko=C({__name:"content",props:{node:{}},setup(i){const s=i,e=V("");return Z(()=>{const t=s.node;t.users.length>0?J(t.users).then(n=>{n.success&&(e.value=n.data.map(a=>a.name).join("、"))}):e.value="未指定人员"}),(t,n)=>{const a=z;return f(),$(a,null,{default:l(()=>[m(A(e.value||t.node.name),1)]),_:1})}}}),Wo=C({__name:"index",props:{node:{}},setup(i,{expose:s}){const e=i,t=V({showError:!1,message:""});return s({validate:()=>(e.node.users.length===0&&(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未指定抄送人`}),t.value)}),(a,r)=>(f(),$(Q,Le({icon:"Promotion"},a.$attrs,{color:"#3296FA","error-info":t.value,node:a.node}),{default:l(()=>[o(Ko,{node:a.node},null,8,["node"])]),_:1},16,["error-info","node"]))}}),Jo=C({__name:"content",props:{node:{}},setup(i){const s=i,e=V(o("span",null,null));return Z(()=>{if(s.node.def)return e.value=o("span",null,[m("不满足条件时，进入默认条件")]);s.node.conditions.conditions.length>0||s.node.conditions.groups.length>0?e.value=o("span",null,[m("已设置（"),s.node.conditions.conditions.length+s.node.conditions.groups.length,m("）个条件")]):e.value=o("span",null,[m("未设置条件")])}),(t,n)=>{const a=z;return f(),$(a,null,{default:l(()=>[o(d(e))]),_:1})}}}),Xo={class:"condition-box"},Yo=C({__name:"index",props:{node:{}},setup(i,{expose:s}){const e=i,t=V({showError:!1,message:""});return s({validate:()=>{if(!e.node.def)return e.node.conditions.conditions.length===0&&e.node.conditions.groups.length===0&&(t.value={showError:!0,message:`节点：[ ${e.node.name} ] 未设置条件`}),t.value}}),(a,r)=>(f(),T("div",Xo,[o(Q,{icon:"Share",readOnly:a.node.def,"error-info":t.value,node:a.node},{default:l(()=>[o(Jo,{node:a.node},null,8,["node"])]),_:1},8,["readOnly","error-info","node"])]))}});const Zo=U(Yo,[["__scopeId","data-v-b27a3f3d"]]),ee=i=>(se("data-v-1ca7350c"),i=i(),le(),i),Qo={class:"branch-node"},et={class:"add-branch"},ot=ee(()=>b("div",{class:M("top-right-border")},null,-1)),tt=ee(()=>b("div",{class:M("bottom-right-border")},null,-1)),nt=ee(()=>b("div",{class:M("top-left-border")},null,-1)),st=ee(()=>b("div",{class:M("bottom-left-border")},null,-1)),lt=C({__name:"index",props:{node:{}},setup(i){const{addNode:s}=X("nodeHooks");return(e,t)=>(f(),T(R,null,[b("div",Qo,[b("div",et,[Y(e.$slots,"default",{},void 0,!0)]),(f(!0),T(R,null,ye(e.node.children,(n,a)=>(f(),T("div",{key:n.id,class:"col-box"},[e.node.children.length===a+1?(f(),T(R,{key:0},[ot,tt],64)):P("",!0),a===0?(f(),T(R,{key:1},[nt,st],64)):P("",!0),o(ze,{node:n},null,8,["node"])]))),128))]),o(Pe,{onAddNode:t[0]||(t[0]=n=>d(s)(n,e.node)),class:"branch-but"})],64))}});const at=U(lt,[["__scopeId","data-v-1ca7350c"]]),rt=C({__name:"index",props:{node:{}},setup(i){const{addNode:s}=X("nodeHooks");return(e,t)=>{const n=L;return f(),$(at,{node:e.node},{default:l(()=>[o(n,{type:"primary",onClick:t[0]||(t[0]=a=>d(s)("condition",e.node)),plain:"",round:""},{default:l(()=>[m("添加条件")]),_:1})]),_:1},8,["node"])}}});const dt={},it={class:"node-box"};function ut(i,s){const e=z;return f(),T("div",it,[o(e,{class:"end-node"},{default:l(()=>[m(" 结束 ")]),_:1})])}const ct=U(dt,[["render",ut],["__scopeId","data-v-74763bb4"]]),pt=C({name:"NodeTree"}),_t=C({...pt,props:{node:{}},setup(i){const s={start:Do,approval:Go,cc:Wo,condition:Zo,exclusive:rt,end:ct},{addNodeRef:e}=X("nodeHooks");return(t,n)=>{const a=je("NodeTree");return f(),T(R,null,[Y(t.$slots,"default",{},void 0,!0),(f(),$(ae(s[t.node.type]),{node:t.node,ref:r=>r&&d(e)(t.node.id,r)},null,8,["node"])),t.node.child?(f(),$(a,{key:0,node:t.node.child},null,8,["node"])):P("",!0)],64)}}});const ze=U(_t,[["__scopeId","data-v-64d33364"]]),mt={class:"flex-center",style:{gap:"4px","grid-gap":"4px"}},ft=C({__name:"UserTag",props:{username:{},type:{default:"info"},closable:{type:Boolean,default:!1}},emits:["close"],setup(i,{emit:s}){const e=i;let t=re({username:void 0,avatar:void 0,name:void 0});qe(()=>{if(!e.username)throw new Error("username is required");qo(e.username).then(h=>{h.success&&(t.username=h.data.username,t.avatar=h.data.avatar,t.name=h.data.name)})}),O(()=>{const h="/api";return h.startsWith("http")?h:window.location.origin+h});const n=de(),a=O(()=>ne[n.value||"default"]-12),r=()=>{s("close",e.username)};return(h,k)=>{const w=Ve,N=Qe;return f(),$(N,{round:"",closable:e.closable,type:h.type,effect:"light",onClose:r},{default:l(()=>[b("div",mt,[o(w,{size:a.value,src:d(t).avatar},{default:l(()=>[m(A((d(t).name||h.username).charAt(0)),1)]),_:1},8,["size","src"]),b("span",null,A(d(t).name||h.username),1)])]),_:1},8,["closable","type"])}}});const me=U(ft,[["__scopeId","data-v-11e894be"]]),vt={class:"flex flex-1 flex-items-center flex-justify-between"},ht={class:"flex-center"},gt=C({__name:"UserPicker",props:{modelValue:{},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{expose:s,emit:e}){const t=i,n={label:"name",children:"children",isLeaf:"leaf",class:g=>N(g)},a=pe(t,"modelValue",e),r=V([]),h=V([]),k=V(),w=V([]),N=g=>r.value.find(v=>v.id===g.id)?"is-active":"",I=g=>{if(g.type==="user")if(t.multiple){const y=r.value.findIndex(v=>v.id===g.id);y===-1?(r.value.push(g),r.value.sort((v,B)=>v.id.localeCompare(B.id))):r.value.splice(y,1)}else{const y=r.value.findIndex(v=>v.id===g.id);y===-1?r.value=[g]:r.value.splice(y,1)}},E=V(!1),x=re({name:null});He(()=>x.name,g=>{var y;(y=k.value)==null||y.filter(g)});const u=(g,y)=>g?y.name.includes(g):!0,c=()=>{E.value=!0},p=()=>{J().then(y=>{y.success&&(h.value=y.data.map(v=>({id:v.username,name:v.name,type:"user",leaf:!0,avatar:v.avatar})))});let g=[];Array.isArray(a.value)?g.push(...a.value):a.value&&g.push(a.value),g.length>0?J(g).then(y=>{y.success&&(r.value=y.data.map(v=>({id:v.username,name:v.name,avatar:v.avatar,type:"user",leaf:!0})),r.value.sort((v,B)=>v.id.localeCompare(B.id)))}):r.value=[]},_=()=>{t.multiple?a.value=r.value.map(g=>g.id):r.value.length>0?a.value=r.value[0].id:a.value=null,E.value=!1};return s({open:c}),(g,y)=>{const v=ie,B=Ve,K=q,oe=eo,F=oo,Fe=xe,he=L,Re=to;return f(),$(Re,{modelValue:E.value,"onUpdate:modelValue":y[2]||(y[2]=S=>E.value=S),onOpen:p,"align-center":"",draggable:"",title:"选择用户",width:"30%"},{footer:l(()=>[o(he,{onClick:y[1]||(y[1]=S=>E.value=!1)},{default:l(()=>[m("取消")]),_:1}),o(he,{type:"primary",onClick:_},{default:l(()=>[m("确认")]),_:1})]),default:l(()=>[o(Fe,{shadow:"never",class:"org-card"},{header:l(()=>[o(v,{modelValue:x.name,"onUpdate:modelValue":y[0]||(y[0]=S=>x.name=S),placeholder:"输入关键字进行查询",style:{width:"100%"},"suffix-icon":"search",clearable:""},null,8,["modelValue"])]),default:l(()=>[o(F,{tag:"div",class:"org-tree"},{default:l(()=>[o(oe,{ref_key:"orgTreeRef",ref:k,"node-key":"id",data:h.value,"default-expanded-keys":w.value,props:n,"filter-node-method":u,onNodeClick:I},{default:l(({data:S})=>[b("div",vt,[b("div",ht,[S.type==="user"?(f(),$(B,{key:0,size:25,src:S.avatar},{default:l(()=>[m(A(S.name.charAt(0)),1)]),_:2},1032,["src"])):(f(),$(K,{key:1,size:16},{default:l(()=>[o(d(wo))]),_:1})),m("  "+A(S.name),1)]),o(K,{class:"is-selected"},{default:l(()=>[o(d($o))]),_:1})])]),_:1},8,["data","default-expanded-keys"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const fe=U(gt,[["__scopeId","data-v-54f06cf8"]]),bt={class:"user-wrapper"},yt=C({__name:"UserSelector",props:{modelValue:{},placeholder:{default:"请选择用户"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},style:{}},emits:["update:modelValue"],setup(i,{emit:s}){const e=i,t=pe(e,"modelValue",s),n=O(()=>t.value?Array.isArray(t.value)?t.value:[t.value]:[]),a=V(),r=no(),h=de(),k=O(()=>r.value||e.disabled),w=()=>{var I;(I=a.value)==null||I.open()},N=I=>{t.value&&(e.multiple&&Array.isArray(t.value)?t.value.splice(t.value.indexOf(I),1):t.value=null)};return(I,E)=>{const x=q,u=L,c=z;return f(),T(R,null,[o(fe,{ref_key:"userPickerRef",ref:a,multiple:I.multiple,modelValue:d(t),"onUpdate:modelValue":E[0]||(E[0]=p=>we(t)?t.value=p:null)},null,8,["multiple","modelValue"]),b("div",bt,[o(u,{class:"user-but-item",size:d(h),disabled:k.value,onClick:w,circle:""},{default:l(()=>[o(x,null,{default:l(()=>[o(d(xo))]),_:1})]),_:1},8,["size","disabled"]),(f(!0),T(R,null,ye(n.value,p=>(f(),$(me,{closable:!k.value,key:p,username:p,onClose:N},null,8,["closable","username"]))),128)),D(o(c,{class:"placeholder"},{default:l(()=>[m(A(I.placeholder),1)]),_:1},512),[[j,!d(t)||d(t).length===0]])])],64)}}});const wt=U(yt,[["__scopeId","data-v-478c5cf7"]]);ke(me);ke(fe);const Be=so(wt,{userTag:me,userPicker:fe}),$t=C({__name:"index",props:{block:{type:Boolean,default:!0},modelValue:{}},emits:["update:modelValue"],setup(i,{emit:s}){const t=pe(i,"modelValue",s);return(n,a)=>{const r=lo;return f(),$(r,{modelValue:d(t),"onUpdate:modelValue":a[0]||(a[0]=h=>we(t)?t.value=h:null),class:M(["el-segmented",{"is-block":n.block}])},{default:l(()=>[Y(n.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue","class"])}}});const ve=U($t,[["__scopeId","data-v-6406405a"]]),G=i=>(se("data-v-5180c8b6"),i=i(),le(),i),xt={class:"flow-opt-item"},Vt={class:"flow-opt-item__content"},kt=G(()=>b("div",{class:"flow-opt-item__second"}," 同意描述、同意描述、同意描述、同意描述、同意描述、同意描述 ",-1)),Et={class:"flow-opt-item"},Ct={class:"flow-opt-item__content"},It=G(()=>b("div",{class:"flow-opt-item__second"}," 拒绝描述、拒绝描述、拒绝描述、拒绝描述、拒绝描述、拒绝描述 ",-1)),Nt={class:"flow-opt-item"},Tt={class:"flow-opt-item__content"},Ut=G(()=>b("div",{class:"flow-opt-item__second"}," 转办描述、转办描述、转办描述、转办描述、转办描述、转办描述 ",-1)),At={class:"flow-opt-item"},Pt={class:"flow-opt-item__content"},St=G(()=>b("div",{class:"flow-opt-item__second"}," 加签描述、加签描述、加签描述、加签描述、加签描述、加签描述 ",-1)),zt={class:"flow-opt-item"},Bt={class:"flow-opt-item__content"},Ft=G(()=>b("div",{class:"flow-opt-item__second"}," 减签描述、减签描述、减签描述、减签描述、减签描述、减签描述 ",-1)),Rt=C({__name:"ApprovalAttr",props:{node:{}},emits:["update:node"],setup(i,{emit:s}){const e=i,t=V("properties"),{node:n}=H(e,s);return(a,r)=>{const h=ao,k=ro,w=Ee,N=Be,I=io,E=z,x=uo,u=co,c=Ce,p=ue,_=q,g=po,y=_o;return f(),$(d(ve),{modelValue:t.value,"onUpdate:modelValue":r[11]||(r[11]=v=>t.value=v),stretch:"",block:!1},{default:l(()=>[o(p,{label:"设置审批人",name:"properties"},{default:l(()=>[o(c,{"label-position":"top","label-width":"90px"},{default:l(()=>[o(w,{prop:"assigneeType",label:"审批对象"},{default:l(()=>[o(k,{modelValue:d(n).assigneeType,"onUpdate:modelValue":r[0]||(r[0]=v=>d(n).assigneeType=v)},{default:l(()=>[o(h,{label:"user"},{default:l(()=>[m("指定人员")]),_:1}),o(h,{label:"role"},{default:l(()=>[m("指定角色")]),_:1}),o(h,{label:"choice"},{default:l(()=>[m("发起人自选")]),_:1}),o(h,{label:"self"},{default:l(()=>[m("发起人自己")]),_:1}),o(h,{label:"leader"},{default:l(()=>[m("多级上级")]),_:1}),o(h,{label:"formUser"},{default:l(()=>[m("表单内人员")]),_:1}),o(h,{label:"formRole"},{default:l(()=>[m("表单内角色")]),_:1})]),_:1},8,["modelValue"])]),_:1}),d(n).assigneeType==="user"?(f(),$(w,{key:0,prop:"users",label:"指定人员"},{default:l(()=>[o(N,{multiple:"",placeholder:"请选择人员",modelValue:d(n).users,"onUpdate:modelValue":r[1]||(r[1]=v=>d(n).users=v)},null,8,["modelValue"])]),_:1})):P("",!0),d(n).assigneeType==="choice"?(f(),$(w,{key:1,prop:"selfSelect",label:"发起人自选择"},{default:l(()=>[o(k,{modelValue:d(n).choice,"onUpdate:modelValue":r[2]||(r[2]=v=>d(n).choice=v)},{default:l(()=>[o(I,{label:!1},{default:l(()=>[m("单选")]),_:1}),o(I,{label:!0},{default:l(()=>[m("多选")]),_:1})]),_:1},8,["modelValue"])]),_:1})):P("",!0),d(n).assigneeType==="self"?(f(),$(w,{key:2,prop:"self",label:"发起人自己"},{default:l(()=>[o(E,null,{default:l(()=>[m(" 发起人自己作为审批人进行审批 ")]),_:1})]),_:1})):P("",!0),d(n).assigneeType==="leader"?(f(),$(w,{key:3,prop:"leader",label:"多级上级"},{default:l(()=>[o(u,{modelValue:d(n).leader,"onUpdate:modelValue":r[3]||(r[3]=v=>d(n).leader=v),placeholder:"请选择多级上级"},{default:l(()=>[o(x,{label:"直属上级",value:1}),o(x,{label:"二级上级",value:2}),o(x,{label:"三级上级",value:3}),o(x,{label:"四级上级",value:4}),o(x,{label:"五级上级",value:5}),o(x,{label:"六级上级",value:6}),o(x,{label:"七级上级",value:7}),o(x,{label:"八级上级",value:8}),o(x,{label:"九级上级",value:9}),o(x,{label:"十级上级",value:10}),o(x,{label:"十一级上级",value:11})]),_:1},8,["modelValue"])]),_:1})):P("",!0),d(n).assigneeType==="role"?(f(),$(w,{key:4,prop:"roles",label:"指定角色"},{default:l(()=>[m(" 待添加... ")]),_:1})):P("",!0),d(n).assigneeType==="formUser"?(f(),$(w,{key:5,prop:"formUser",label:"表单内人员"},{default:l(()=>[m(" 待添加... ")]),_:1})):P("",!0),d(n).assigneeType==="formRole"?(f(),$(w,{key:6,prop:"formRole",label:"表单内角色"},{default:l(()=>[m(" 待添加... ")]),_:1})):P("",!0),o(w,{prop:"method",label:"多人审批方式"},{default:l(()=>[o(k,{class:"flex-column",modelValue:d(n).multi,"onUpdate:modelValue":r[4]||(r[4]=v=>d(n).multi=v)},{default:l(()=>[o(h,{label:"sequential"},{default:l(()=>[m("依次审批")]),_:1}),o(h,{label:"joint"},{default:l(()=>[m("会签（需要所有审批人都通过才可通过）")]),_:1}),o(h,{label:"single"},{default:l(()=>[m("或签（其中一名审批人通过或驳回即可）")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(w,{prop:"nobody",label:"审批人为空"},{default:l(()=>[o(k,{modelValue:d(n).nobody,"onUpdate:modelValue":r[5]||(r[5]=v=>d(n).nobody=v)},{default:l(()=>[o(h,{label:"pass"},{default:l(()=>[m("自动通过")]),_:1}),o(h,{label:"reject"},{default:l(()=>[m("自动驳回")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(p,{label:"表单权限",name:"formPermissions"},{default:l(()=>[m(" 待添加... ")]),_:1}),o(p,{label:"操作权限",name:"operationPermissions"},{default:l(()=>[b("div",xt,[o(_,{size:32,class:"flow-opt-item__icon"},{default:l(()=>[o(d(Vo))]),_:1}),b("div",Vt,[o(E,{tag:"b"},{default:l(()=>[m(" 同意 ")]),_:1}),kt]),o(g,{modelValue:d(n).operations.complete,"onUpdate:modelValue":r[6]||(r[6]=v=>d(n).operations.complete=v),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),o(y),b("div",Et,[o(_,{size:32,class:"flow-opt-item__icon"},{default:l(()=>[o(d(Ue))]),_:1}),b("div",Ct,[o(E,{tag:"b"},{default:l(()=>[m(" 拒绝 ")]),_:1}),It]),o(g,{modelValue:d(n).operations.refuse,"onUpdate:modelValue":r[7]||(r[7]=v=>d(n).operations.refuse=v),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),o(y),b("div",Nt,[o(_,{size:32,class:"flow-opt-item__icon"},{default:l(()=>[o(d(ko))]),_:1}),b("div",Tt,[o(E,{tag:"b"},{default:l(()=>[m(" 转办 ")]),_:1}),Ut]),o(g,{modelValue:d(n).operations.transfer,"onUpdate:modelValue":r[8]||(r[8]=v=>d(n).operations.transfer=v),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),o(y),b("div",At,[o(_,{size:32,class:"flow-opt-item__icon"},{default:l(()=>[o(d(ce))]),_:1}),b("div",Pt,[o(E,{tag:"b"},{default:l(()=>[m(" 加签 ")]),_:1}),St]),o(g,{modelValue:d(n).operations.addMulti,"onUpdate:modelValue":r[9]||(r[9]=v=>d(n).operations.addMulti=v),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),o(y),b("div",zt,[o(_,{size:32,class:"flow-opt-item__icon"},{default:l(()=>[o(d(Ae))]),_:1}),b("div",Bt,[o(E,{tag:"b"},{default:l(()=>[m(" 减签 ")]),_:1}),Ft]),o(g,{modelValue:d(n).operations.minusMulti,"onUpdate:modelValue":r[10]||(r[10]=v=>d(n).operations.minusMulti=v),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),o(y)]),_:1})]),_:1},8,["modelValue"])}}});const Ot=U(Rt,[["__scopeId","data-v-5180c8b6"]]),Mt=C({__name:"CcAttr",props:{node:{}},emits:["update:node"],setup(i,{emit:s}){const e=i,t=V("properties"),{node:n}=H(e,s);return(a,r)=>{const h=Be,k=Ee,w=Ce,N=ue;return f(),$(d(ve),{modelValue:t.value,"onUpdate:modelValue":r[1]||(r[1]=I=>t.value=I),stretch:"",block:!1},{default:l(()=>[o(N,{label:"设置抄送人",name:"properties"},{default:l(()=>[o(w,{"label-position":"top","label-width":"90px"},{default:l(()=>[o(k,{prop:"users",label:"抄送人"},{default:l(()=>[o(h,{multiple:"",placeholder:"请选择人员",modelValue:d(n).users,"onUpdate:modelValue":r[0]||(r[0]=I=>d(n).users=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(N,{label:"表单权限",name:"formPermissions"},{default:l(()=>[m(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),Dt=C({__name:"StartAttr",props:{node:{}},emits:["update:node"],setup(i,{emit:s}){const e=i,t=V("formPermissions");return H(e,s),(n,a)=>{const r=ue;return f(),$(d(ve),{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=h=>t.value=h),stretch:"",block:!1},{default:l(()=>[o(r,{label:"表单权限",name:"formPermissions"},{default:l(()=>[m(" 待添加... ")]),_:1}),o(r,{label:"操作权限",name:"operationPermissions"},{default:l(()=>[m(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),Lt=["id"],jt=C({__name:"index",setup(i,{expose:s}){const e={start:Dt,approval:Ot,cc:Mt};let t=V({id:"",pid:"",type:"",name:"",child:null});const n=V(!1),a=V(!1),r=()=>{a.value&&(a.value=!1)};return s({open:k=>{t.value=k,n.value=!0}}),(k,w)=>{const N=ie,I=mo,E=fo;return f(),$(E,{modelValue:n.value,"onUpdate:modelValue":w[2]||(w[2]=x=>n.value=x),size:"35%"},{header:l(({titleId:x,titleClass:u})=>[b("span",{id:x,class:M(u)},[D(o(N,{onBlur:r,maxlength:"30",modelValue:d(t).name,"onUpdate:modelValue":w[0]||(w[0]=c=>d(t).name=c)},null,8,["modelValue"]),[[d($e),r],[j,a.value]]),D(o(I,{icon:"EditPen",onClick:w[1]||(w[1]=c=>a.value=!0)},{default:l(()=>[m(A(d(t).name),1)]),_:1},512),[[j,!a.value]])],10,Lt)]),default:l(()=>[(f(),$(ae(e[d(t).type]),{node:d(t)},null,8,["node"]))]),_:1},8,["modelValue"])}}});const qt=U(jt,[["__scopeId","data-v-e9c31a05"]]),Ht=i=>{const s=V(new Map),e=V(new Map),t=()=>(s.value.clear(),e.value.forEach((u,c)=>{const p=u==null?void 0:u.validate;if(p){const _=p();_&&_.showError&&s.value.set(c,_.message)}}),s),n=(u,c)=>{e.value.set(u,c)},a=()=>{let u=`node-${Math.random().toString(36).substring(2,7)}`;const c=(p,_)=>{if(p.id===_)return!0;if(p.child)return c(p.child,_);if("children"in p){const g=p;if(g.children&&g.children.length>0)return g.children.some(y=>c(y,_))}return!1};return c(i.value,u)?a():u},r=u=>{const c=u;c.children.unshift({id:a(),pid:u.id,type:"condition",def:!1,name:`条件${c.children.length+1}`,conditions:{logicalOperator:"and",conditions:[],groups:[]},child:null})},N={condition:r,approval:u=>{const c=u.child,p=a();u.child={id:p,pid:u.id,type:"approval",name:"审批人",child:c,assigneeType:"user",formUser:"",formRole:"",users:[],roles:[],leader:1,multi:"sequential",choice:!1,self:!1,nobody:"pass",operations:{complete:!0,refuse:!0,transfer:!1,addMulti:!1,minusMulti:!1}},c&&(c.pid=p)},cc:u=>{const c=u.child,p=a();u.child={id:p,pid:u.id,type:"cc",name:"抄送人",child:c,users:[]},c&&(c.pid=p)},exclusive:u=>{const c=u.child,p=a(),_={id:p,pid:u.id,type:"exclusive",name:"独占网关",child:c,children:[]};if(u.child=_,c&&(c.pid=p),r(u.child),r(u.child),_.children.length>0){const g=_.children[_.children.length-1];g.def=!0,g.name="默认条件"}}},I=(u,c)=>{const p=N[u];p&&p(c)},E=u=>{x(i.value,u)},x=(u,c)=>{var p;if(u.id===c.pid)if("children"in u&&((p=u.child)==null?void 0:p.id)!==c.id){const _=u,g=_.children.findIndex(y=>y.id===c.id);g!==-1&&(_.children.length<=2?E(_):_.children.splice(g,1))}else c.child&&c.child.pid&&(c.child.pid=u.id),u.child=c.child;else if(u.child&&x(u.child,c),"children"in u){const _=u;_.children&&_.children.length>0&&_.children.forEach(g=>{x(g,c)})}};return{addNode:I,delNode:E,addNodeRef:n,validateNodes:t,nodeErrors:s}},Gt={class:"designer-container"},Kt={class:"zoom"},Wt={class:"node-container"},Jt=C({name:"flowDesign"}),Xt=C({...Jt,props:{process:{}},emits:["update:process"],setup(i,{emit:s}){const e=i;be(u=>({"456f8ba4":r.value}));const{process:t}=H(e,s),n=V(),a=V(100),r=O(()=>a.value/100),h=u=>{var c;(c=n.value)==null||c.open(u)},{addNode:k,delNode:w,validateNodes:N,addNodeRef:I}=Ht(t);Ge("nodeHooks",{readOnly:!1,addNode:k,delNode:w,addNodeRef:I,openPenal:h});const E=u=>{u.shiftKey&&(u.deltaY>0?a.value>50&&(a.value-=10):a.value<170&&(a.value+=10))},x=()=>{N()};return window.addEventListener("wheel",E),Ke(()=>{window.removeEventListener("wheel",E)}),(u,c)=>{const p=L;return f(),T("div",Gt,[b("div",Kt,[o(p,{icon:d(ce),onClick:c[0]||(c[0]=_=>a.value+=10),disabled:a.value>=170,circle:""},null,8,["icon","disabled"]),b("span",null,A(a.value)+"%",1),o(p,{icon:d(Ae),onClick:c[1]||(c[1]=_=>a.value-=10),circle:"",disabled:a.value<=50},null,8,["icon","disabled"]),o(p,{onClick:x},{default:l(()=>[m("校验")]),_:1})]),b("div",Wt,[o(ze,{node:d(t)},null,8,["node"])]),o(qt,{ref_key:"nodePenalRef",ref:n},null,512)])}}});const Yt=U(Xt,[["__scopeId","data-v-4a49a62e"]]),Zt=C({__name:"App",setup(i){const s=re({id:"root",pid:null,type:"start",name:"发起人",child:{id:"end",pid:"root",type:"end",name:"结束",child:null}});return(e,t)=>{const n=ho;return f(),$(n,{namespace:"el",locale:d(vo)},{default:l(()=>[o(Yt,{process:s},null,8,["process"])]),_:1},8,["locale"])}}});const te=[{id:1,name:"张三",username:"admin",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:2,name:"李四",username:"lisi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:3,name:"王五",username:"wangwu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:4,name:"赵六",username:"zhaoliu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:5,name:"孙七",username:"sunqi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:6,name:"周八",username:"zhouba",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:7,name:"吴九",username:"wujui",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:8,name:"郑十",username:"zhengshi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"}],Qt=[{url:"/api/user/info",method:"get",response:i=>{const s=i.query.username;return{code:200,success:!0,message:"操作成功",data:te.find(e=>e.username===s)}}},{url:"/api/user/list",method:"post",response:i=>{const s=i.body.userIds;return{code:200,success:!0,message:"操作成功",data:Array.isArray(s)?te.filter(e=>s.includes(e.username)):te}}}],en=[...Qt],on=[...en];function tn(){Co(on)}const nn=We(Zt);nn.mount("#app");tn();
