var Me=Object.defineProperty;var Le=(r,n,t)=>n in r?Me(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t;var he=(r,n,t)=>(Le(r,typeof n!="symbol"?n+"":n,t),t);import{E as w,d as E,o as _,c as P,O as e,R as s,u as d,a as y,am as oe,an as ne,ao as be,i as M,z as le,a0 as Q,_ as F,S as V,V as b,W as A,T as se,X as T,$ as G,F as W,n as je,w as J,G as Fe,P as B,ah as ye,L,ad as qe,J as ae,h as De,e as He,A as ge,D as Ge,I as Ke,ap as We}from"./@vue-f145ebf9.js";import{E as Je,a as q,b as j,u as de,c as te,d as xe,C as Ve,e as re,f as z,g as Xe,h as Ye,i as Ze,j as $e,k as Qe,l as et,m as tt,n as ot,w as we,o as nt,p as lt,q as st,r as at,s as ke,t as dt,v as rt,x as it,y as Ce,z as ie,A as ct,B as ut,D as _t,F as pt,G as mt,H as ft}from"./element-plus-85b67eaa.js";import{p as ce,k as Ee,m as Ne,n as Pe,o as vt,a as Ie,r as ht,t as bt,u as yt,x as gt,c as xt,y as Vt,z as Ue}from"./@element-plus-ef6d10d8.js";import{h as X,j as ue}from"./@vueuse-caf007e4.js";import{a as $t}from"./axios-21b846bc.js";import{c as wt}from"./vite-plugin-mock-a6c9e661.js";import"./lodash-es-90b76008.js";import"./async-validator-dee29e8b.js";import"./@sxzz-c75af06c.js";import"./@ctrl-f8748455.js";import"./mockjs-26f03dd7.js";import"./dayjs-725317a4.js";import"./path-to-regexp-31db6522.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(l){if(l.ep)return;l.ep=!0;const i=t(l);fetch(l.href,i)}})();const _e=r=>(oe("data-v-e5f31a23"),r=r(),ne(),r),kt={class:"add-but"},Ct={class:"node-select"},Et=_e(()=>y("span",null,"审批人",-1)),Nt=_e(()=>y("span",null,"抄送人",-1)),Pt=_e(()=>y("span",null,"互斥分支",-1)),It=w({__name:"index",emits:["addNode"],setup(r,{emit:n}){const t=E(),o=()=>{var a;n("addNode","approval"),(a=t.value)==null||a.hide()},l=()=>{var a;n("addNode","cc"),(a=t.value)==null||a.hide()},i=()=>{var a;n("addNode","exclusive"),(a=t.value)==null||a.hide()};return(a,p)=>{const $=q,h=j,c=Je;return _(),P("div",kt,[e(c,{placement:"bottom-start",ref_key:"nodePopoverRef",ref:t,trigger:"click",title:"添加节点",width:235},{reference:s(()=>[e(h,{icon:d(ce),type:"primary",style:{"z-index":"1"},circle:""},null,8,["icon"])]),default:s(()=>[y("div",Ct,[y("div",{onClick:o},[e($,{color:"#ff943e"},{default:s(()=>[e(d(Ee))]),_:1}),Et]),y("div",{onClick:l},[e($,{color:"#3296fa"},{default:s(()=>[e(d(Ne))]),_:1}),Nt]),y("div",{onClick:i},[e($,null,{default:s(()=>[e(d(Pe))]),_:1}),Pt])])]),_:1},512)])}}});const U=(r,n)=>{const t=r.__vccOpts||r;for(const[o,l]of n)t[o]=l;return t},Te=U(It,[["__scopeId","data-v-e5f31a23"]]),Ut={class:"node-box"},Tt={class:"head"},At={key:2},St=w({__name:"index",props:{icon:{},node:{},color:{},readOnly:{type:Boolean,default:!1},close:{type:Boolean,default:!0},arrow:{type:Boolean,default:!0}},emits:["update:node"],setup(r,{emit:n}){const t=r;be(C=>({"491d81de":h.value,"21b9cac8":$.value,"0d2f2c80":C.color}));const o={list:ht,stamp:Ee,share:Pe,promotion:Ne},{node:l}=X(t,n),i=E(!1),a=E(),p=de(),$=M(()=>te[p.value||"default"]+205+"px"),h=M(()=>te[p.value||"default"]+60+"px"),{addNode:c,delNode:u,openPenal:f}=le("nodeHooks"),v=()=>{t.readOnly||f(l.value)},k=()=>{t.readOnly||(i.value=!0,je(()=>{var C;(C=a.value)==null||C.focus()}))},I=()=>{i.value&&(i.value=!1)};return(C,N)=>{const x=q,g=z,m=j,O=Xe,H=xe;return _(),P("div",Ut,[e(H,{shadow:"always",onClick:N[4]||(N[4]=R=>v()),class:"node"},{header:s(()=>[y("div",Tt,[i.value?(_(),P("div",{key:0,onClick:N[1]||(N[1]=Q(()=>{},["stop"]))},[F(e(d(re),{ref_key:"inputRef",ref:a,onBlur:I,maxlength:"30",modelValue:d(l).name,"onUpdate:modelValue":N[0]||(N[0]=R=>d(l).name=R)},null,8,["modelValue"]),[[d(Ve),I]])])):(_(),V(g,{key:1,tag:"b",truncated:"",onClick:Q(k,["stop"])},{default:s(()=>[b(A(d(l).name)+" ",1),e(x,null,{default:s(()=>[e(d(vt))]),_:1})]),_:1},8,["onClick"])),C.icon?(_(),P("span",At,[e(x,{size:30,color:"node-icon"},{default:s(()=>[(_(),V(se(o[C.icon.toLowerCase()])))]),_:1})])):T("",!0)])]),default:s(()=>[y("div",{onClick:N[3]||(N[3]=Q(()=>{},["stop"]))},[e(O,{title:"您确定要删除该节点吗？",width:"200","hide-after":0,placement:"right-start",onConfirm:N[2]||(N[2]=R=>d(u)(d(l)))},{reference:s(()=>[F(e(m,{class:"node-close",plain:"",circle:"",icon:d(Ie),size:"small",type:"danger"},null,8,["icon"]),[[G,C.close&&!C.readOnly]])]),_:1})]),W(C.$slots,"default",{},void 0,!0)]),_:3}),e(Te,{onAddNode:N[5]||(N[5]=R=>d(c)(R,d(l)))})])}}});const Y=U(St,[["__scopeId","data-v-315ac0a7"]]),zt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=E("");return J(()=>{t.value=n.node.name}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[b(A(t.value||o.node.name),1)]),_:1})}}}),Ot={class:"start-box"},Rt=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),P("div",Ot,[e(Y,{icon:"List",arrow:!1,close:!1,color:"#8c7cf3",node:n.node},{default:s(()=>[e(zt,{node:n.node},null,8,["node"])]),_:1},8,["node"])]))}});const Bt=U(Rt,[["__scopeId","data-v-0a059602"]]),Mt={baseURL:"/api",timeout:8e3};class Lt{constructor(n){he(this,"service");this.service=$t.create(n),this.service.interceptors.request.use(t=>(t.headers.Authorization="Bearer 87779e5a-3342-4df6-865d-d8828800d6fb",t),t=>Promise.reject(t)),this.service.interceptors.response.use(t=>{const{data:o}=t;return o},t=>{const{response:o,message:l}=t,i=o==null?void 0:o.data,a=i?i.message:l;return Ye.error(a||"未知错误"),Promise.reject((o==null?void 0:o.data)||t)})}get(n,t,o={}){return this.service.get(n,{params:t,...o})}post(n,t){return this.service.post(n,t)}put(n,t){return this.service.put(n,t)}delete(n,t){return this.service.delete(n,t)}patch(n,t){return this.service.patch(n,t)}head(n){return this.service.head(n)}options(n){return this.service.options(n)}request(n){return this.service.request(n)}download(n,t){return this.service.post(n,t,{responseType:"blob"})}}const Ae=new Lt(Mt),jt=r=>Ae.get("/user/info",{username:r}),K=r=>{const n=r?{userIds:r}:{};return Ae.post("/user/list",n)},Ft=w({__name:"content",props:{node:{}},setup(r){const n=r,t=E("");return J(()=>{const o=n.node;o.assigneeType==="choice"?t.value=`发起人自选（${o.choice?"多选":"单选"}）`:o.assigneeType==="self"?t.value="发起人自己":o.assigneeType==="leader"?t.value=o.leader===1?"直属上级":`${o.leader}级上级`:o.assigneeType==="formUser"?t.value="表单内人员":o.assigneeType==="user"?o.users.length>0?K(o.users).then(l=>{l.success&&(t.value=l.data.map(i=>i.name).join("、"))}):t.value="未指定人员":o.assigneeType==="role"?o.roles.length>0||(t.value="未指定角色"):t.value=n.node.name}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[b(A(t.value||o.node.name),1)]),_:1})}}}),qt=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),V(Y,{icon:"Stamp",color:"linear-gradient(89.96deg, #FA6F32 .05%, #FB9337 79.83%)",node:n.node},{default:s(()=>[e(Ft,{node:n.node},null,8,["node"])]),_:1},8,["node"]))}}),Dt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=E("");return J(()=>{const o=n.node;o.users.length>0?K(o.users).then(l=>{l.success&&(t.value=l.data.map(i=>i.name).join("、"))}):t.value="未指定人员"}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[b(A(t.value||o.node.name),1)]),_:1})}}}),Ht=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),V(Y,Fe({icon:"Promotion"},n.$attrs,{color:"#3296FA",node:n.node}),{default:s(()=>[e(Dt,{node:n.node},null,8,["node"])]),_:1},16,["node"]))}}),Gt=w({__name:"content",props:{node:{}},setup(r){const n=r,t=E(React.createElement("span",null));return J(()=>{if(n.node.def)return t.value=React.createElement("span",null,"不满足条件时，进入默认条件");n.node.conditions.conditions.length>0?t.value=React.createElement("span",null,"已设置（",n.node.conditions.conditions.length,"）个条件"):t.value=React.createElement("span",null,"未设置条件")}),(o,l)=>{const i=z;return _(),V(i,null,{default:s(()=>[e(d(t))]),_:1})}}}),Kt={class:"condition-box"},Wt=w({__name:"index",props:{node:{}},setup(r){return(n,t)=>(_(),P("div",Kt,[e(Y,{icon:"Share",readOnly:n.node.def,node:n.node},{default:s(()=>[e(Gt,{node:n.node},null,8,["node"])]),_:1},8,["readOnly","node"])]))}});const Jt=U(Wt,[["__scopeId","data-v-d12a68c4"]]),Z=r=>(oe("data-v-1ca7350c"),r=r(),ne(),r),Xt={class:"branch-node"},Yt={class:"add-branch"},Zt=Z(()=>y("div",{class:L("top-right-border")},null,-1)),Qt=Z(()=>y("div",{class:L("bottom-right-border")},null,-1)),eo=Z(()=>y("div",{class:L("top-left-border")},null,-1)),to=Z(()=>y("div",{class:L("bottom-left-border")},null,-1)),oo=w({__name:"index",props:{node:{}},setup(r){const{addNode:n}=le("nodeHooks");return(t,o)=>(_(),P(B,null,[y("div",Xt,[y("div",Yt,[W(t.$slots,"default",{},void 0,!0)]),(_(!0),P(B,null,ye(t.node.children,(l,i)=>(_(),P("div",{key:l.id,class:"col-box"},[t.node.children.length===i+1?(_(),P(B,{key:0},[Zt,Qt],64)):T("",!0),i===0?(_(),P(B,{key:1},[eo,to],64)):T("",!0),e(Se,{node:l},null,8,["node"])]))),128))]),e(Te,{onAddNode:o[0]||(o[0]=l=>d(n)(l,t.node)),class:"branch-but"})],64))}});const no=U(oo,[["__scopeId","data-v-1ca7350c"]]),lo=w({__name:"index",props:{node:{}},setup(r){const{addNode:n}=le("nodeHooks");return(t,o)=>{const l=j;return _(),V(no,{node:t.node},{default:s(()=>[e(l,{type:"primary",onClick:o[0]||(o[0]=i=>d(n)("condition",t.node)),plain:"",round:""},{default:s(()=>[b("添加条件")]),_:1})]),_:1},8,["node"])}}});const so={},ao={class:"node-box"};function ro(r,n){const t=z;return _(),P("div",ao,[e(t,{class:"end-node"},{default:s(()=>[b(" 结束 ")]),_:1})])}const io=U(so,[["render",ro],["__scopeId","data-v-74763bb4"]]),co=w({name:"NodeTree"}),uo=w({...co,props:{node:{}},setup(r){const n={start:Bt,approval:qt,cc:Ht,condition:Jt,exclusive:lo,end:io};return(t,o)=>{const l=qe("NodeTree");return _(),P(B,null,[W(t.$slots,"default",{},void 0,!0),(_(),V(se(n[t.node.type]),{node:t.node},null,8,["node"])),t.node.child?(_(),V(l,{key:0,node:t.node.child},null,8,["node"])):T("",!0)],64)}}});const Se=U(uo,[["__scopeId","data-v-1288ab88"]]),_o={class:"flex-center",style:{gap:"4px","grid-gap":"4px"}},po=w({__name:"UserTag",props:{username:{},type:{default:"info"},closable:{type:Boolean,default:!1}},emits:["close"],setup(r,{emit:n}){const t=r;let o=ae({username:void 0,avatar:void 0,name:void 0});De(()=>{if(!t.username)throw new Error("username is required");jt(t.username).then(p=>{p.success&&(o.username=p.data.username,o.avatar=p.data.avatar,o.name=p.data.name)})}),M(()=>{const p="/api";return p.startsWith("http")?p:window.location.origin+p});const l=de(),i=M(()=>te[l.value||"default"]-12),a=()=>{n("close",t.username)};return(p,$)=>{const h=$e,c=Ze;return _(),V(c,{round:"",closable:t.closable,type:p.type,effect:"light",onClose:a},{default:s(()=>[y("div",_o,[e(h,{size:i.value,src:d(o).avatar},{default:s(()=>[b(A((d(o).name||p.username).charAt(0)),1)]),_:1},8,["size","src"]),y("span",null,A(d(o).name||p.username),1)])]),_:1},8,["closable","type"])}}});const pe=U(po,[["__scopeId","data-v-11e894be"]]),mo={class:"flex flex-1 flex-items-center flex-justify-between"},fo={class:"flex-center"},vo=w({__name:"UserPicker",props:{modelValue:{},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{expose:n,emit:t}){const o=r,l={label:"name",children:"children",isLeaf:"leaf",class:x=>c(x)},i=ue(o,"modelValue",t),a=E([]),p=E([]),$=E(),h=E([]),c=x=>a.value.find(m=>m.id===x.id)?"is-active":"",u=x=>{if(x.type==="user")if(o.multiple){const g=a.value.findIndex(m=>m.id===x.id);g===-1?(a.value.push(x),a.value.sort((m,O)=>m.id.localeCompare(O.id))):a.value.splice(g,1)}else{const g=a.value.findIndex(m=>m.id===x.id);g===-1?a.value=[x]:a.value.splice(g,1)}},f=E(!1),v=ae({name:null});He(()=>v.name,x=>{var g;(g=$.value)==null||g.filter(x)});const k=(x,g)=>x?g.name.includes(x):!0,I=()=>{f.value=!0},C=()=>{K().then(g=>{g.success&&(p.value=g.data.map(m=>({id:m.username,name:m.name,type:"user",leaf:!0,avatar:m.avatar})))});let x=[];Array.isArray(i.value)?x.push(...i.value):i.value&&x.push(i.value),x.length>0?K(x).then(g=>{g.success&&(a.value=g.data.map(m=>({id:m.username,name:m.name,avatar:m.avatar,type:"user",leaf:!0})),a.value.sort((m,O)=>m.id.localeCompare(O.id)))}):a.value=[]},N=()=>{o.multiple?i.value=a.value.map(x=>x.id):a.value.length>0?i.value=a.value[0].id:i.value=null,f.value=!1};return n({open:I}),(x,g)=>{const m=re,O=$e,H=q,R=et,Oe=tt,Re=xe,ve=j,Be=Qe;return _(),V(Be,{modelValue:f.value,"onUpdate:modelValue":g[2]||(g[2]=S=>f.value=S),onOpen:C,"align-center":"",draggable:"",title:"选择用户",width:"30%"},{footer:s(()=>[e(ve,{onClick:g[1]||(g[1]=S=>f.value=!1)},{default:s(()=>[b("取消")]),_:1}),e(ve,{type:"primary",onClick:N},{default:s(()=>[b("确认")]),_:1})]),default:s(()=>[e(Re,{shadow:"never",class:"org-card"},{header:s(()=>[e(m,{modelValue:v.name,"onUpdate:modelValue":g[0]||(g[0]=S=>v.name=S),placeholder:"输入关键字进行查询",style:{width:"100%"},"suffix-icon":"search",clearable:""},null,8,["modelValue"])]),default:s(()=>[e(Oe,{tag:"div",class:"org-tree"},{default:s(()=>[e(R,{ref_key:"orgTreeRef",ref:$,"node-key":"id",data:p.value,"default-expanded-keys":h.value,props:l,"filter-node-method":k,onNodeClick:u},{default:s(({data:S})=>[y("div",mo,[y("div",fo,[S.type==="user"?(_(),V(O,{key:0,size:25,src:S.avatar},{default:s(()=>[b(A(S.name.charAt(0)),1)]),_:2},1032,["src"])):(_(),V(H,{key:1,size:16},{default:s(()=>[e(d(bt))]),_:1})),b("  "+A(S.name),1)]),e(H,{class:"is-selected"},{default:s(()=>[e(d(yt))]),_:1})])]),_:1},8,["data","default-expanded-keys"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const me=U(vo,[["__scopeId","data-v-54f06cf8"]]),ho={class:"user-wrapper"},bo=w({__name:"UserSelector",props:{modelValue:{},placeholder:{default:"请选择用户"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},style:{}},emits:["update:modelValue"],setup(r,{emit:n}){const t=r,o=ue(t,"modelValue",n),l=M(()=>o.value?Array.isArray(o.value)?o.value:[o.value]:[]),i=E(),a=ot(),p=de(),$=M(()=>a.value||t.disabled),h=()=>{var u;(u=i.value)==null||u.open()},c=u=>{o.value&&(t.multiple&&Array.isArray(o.value)?o.value.splice(o.value.indexOf(u),1):o.value=null)};return(u,f)=>{const v=q,k=j,I=z;return _(),P(B,null,[e(me,{ref_key:"userPickerRef",ref:i,multiple:u.multiple,modelValue:d(o),"onUpdate:modelValue":f[0]||(f[0]=C=>ge(o)?o.value=C:null)},null,8,["multiple","modelValue"]),y("div",ho,[e(k,{class:"user-but-item",size:d(p),disabled:$.value,onClick:h,circle:""},{default:s(()=>[e(v,null,{default:s(()=>[e(d(gt))]),_:1})]),_:1},8,["size","disabled"]),(_(!0),P(B,null,ye(l.value,C=>(_(),V(pe,{closable:!$.value,key:C,username:C,onClose:c},null,8,["closable","username"]))),128)),F(e(I,{class:"placeholder"},{default:s(()=>[b(A(u.placeholder),1)]),_:1},512),[[G,!d(o)||d(o).length===0]])])],64)}}});const yo=U(bo,[["__scopeId","data-v-478c5cf7"]]);we(pe);we(me);const ze=nt(yo,{userTag:pe,userPicker:me}),go=w({__name:"index",props:{block:{type:Boolean,default:!0},modelValue:{}},emits:["update:modelValue"],setup(r,{emit:n}){const o=ue(r,"modelValue",n);return(l,i)=>{const a=lt;return _(),V(a,{modelValue:d(o),"onUpdate:modelValue":i[0]||(i[0]=p=>ge(o)?o.value=p:null),class:L(["el-segmented",{"is-block":l.block}])},{default:s(()=>[W(l.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue","class"])}}});const fe=U(go,[["__scopeId","data-v-6406405a"]]),D=r=>(oe("data-v-05119c57"),r=r(),ne(),r),xo={class:"flow-opt-item"},Vo={class:"flow-opt-item__content"},$o=D(()=>y("div",{class:"flow-opt-item__second"}," 同意描述、同意描述、同意描述、同意描述、同意描述、同意描述 ",-1)),wo={class:"flow-opt-item"},ko={class:"flow-opt-item__content"},Co=D(()=>y("div",{class:"flow-opt-item__second"}," 拒绝描述、拒绝描述、拒绝描述、拒绝描述、拒绝描述、拒绝描述 ",-1)),Eo={class:"flow-opt-item"},No={class:"flow-opt-item__content"},Po=D(()=>y("div",{class:"flow-opt-item__second"}," 转办描述、转办描述、转办描述、转办描述、转办描述、转办描述 ",-1)),Io={class:"flow-opt-item"},Uo={class:"flow-opt-item__content"},To=D(()=>y("div",{class:"flow-opt-item__second"}," 加签描述、加签描述、加签描述、加签描述、加签描述、加签描述 ",-1)),Ao={class:"flow-opt-item"},So={class:"flow-opt-item__content"},zo=D(()=>y("div",{class:"flow-opt-item__second"}," 减签描述、减签描述、减签描述、减签描述、减签描述、减签描述 ",-1)),Oo=w({__name:"ApprovalAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:n}){const t=r,o=E("properties"),{node:l}=X(t,n);return(i,a)=>{const p=st,$=at,h=ke,c=ze,u=dt,f=z,v=rt,k=it,I=Ce,C=ie,N=q,x=ct,g=ut;return _(),V(d(fe),{modelValue:o.value,"onUpdate:modelValue":a[11]||(a[11]=m=>o.value=m),stretch:"",block:!1},{default:s(()=>[e(C,{label:"设置审批人",name:"properties"},{default:s(()=>[e(I,{"label-position":"top","label-width":"90px"},{default:s(()=>[e(h,{prop:"assigneeType",label:"审批对象"},{default:s(()=>[e($,{modelValue:d(l).assigneeType,"onUpdate:modelValue":a[0]||(a[0]=m=>d(l).assigneeType=m)},{default:s(()=>[e(p,{label:"user"},{default:s(()=>[b("指定人员")]),_:1}),e(p,{label:"role"},{default:s(()=>[b("指定角色")]),_:1}),e(p,{label:"choice"},{default:s(()=>[b("发起人自选")]),_:1}),e(p,{label:"self"},{default:s(()=>[b("发起人自己")]),_:1}),e(p,{label:"leader"},{default:s(()=>[b("多级上级")]),_:1}),e(p,{label:"formUser"},{default:s(()=>[b("表单内人员")]),_:1}),e(p,{label:"formRole"},{default:s(()=>[b("表单内角色")]),_:1})]),_:1},8,["modelValue"])]),_:1}),d(l).assigneeType==="user"?(_(),V(h,{key:0,prop:"users",label:"指定人员"},{default:s(()=>[e(c,{multiple:"",placeholder:"请选择人员",modelValue:d(l).users,"onUpdate:modelValue":a[1]||(a[1]=m=>d(l).users=m)},null,8,["modelValue"])]),_:1})):T("",!0),d(l).assigneeType==="choice"?(_(),V(h,{key:1,prop:"selfSelect",label:"发起人自选择"},{default:s(()=>[e($,{modelValue:d(l).choice,"onUpdate:modelValue":a[2]||(a[2]=m=>d(l).choice=m)},{default:s(()=>[e(u,{label:!1},{default:s(()=>[b("单选")]),_:1}),e(u,{label:!0},{default:s(()=>[b("多选")]),_:1})]),_:1},8,["modelValue"])]),_:1})):T("",!0),d(l).assigneeType==="self"?(_(),V(h,{key:2,prop:"self",label:"发起人自己"},{default:s(()=>[e(f,null,{default:s(()=>[b(" 发起人自己作为审批人进行审批 ")]),_:1})]),_:1})):T("",!0),d(l).assigneeType==="leader"?(_(),V(h,{key:3,prop:"leader",label:"直属上级"},{default:s(()=>[e(k,{modelValue:d(l).leader,"onUpdate:modelValue":a[3]||(a[3]=m=>d(l).leader=m),placeholder:"请选择直属上级"},{default:s(()=>[e(v,{label:"直属上级",value:1}),e(v,{label:"二级上级",value:2}),e(v,{label:"三级上级",value:3}),e(v,{label:"四级上级",value:4}),e(v,{label:"五级上级",value:5}),e(v,{label:"六级上级",value:6}),e(v,{label:"七级上级",value:7}),e(v,{label:"八级上级",value:8}),e(v,{label:"九级上级",value:9}),e(v,{label:"十级上级",value:10}),e(v,{label:"十一级上级",value:11})]),_:1},8,["modelValue"])]),_:1})):T("",!0),d(l).assigneeType==="role"?(_(),V(h,{key:4,prop:"roles",label:"指定角色"},{default:s(()=>[b(" 待添加... ")]),_:1})):T("",!0),d(l).assigneeType==="formUser"?(_(),V(h,{key:5,prop:"formUser",label:"表单内人员"},{default:s(()=>[b(" 待添加... ")]),_:1})):T("",!0),d(l).assigneeType==="formRole"?(_(),V(h,{key:6,prop:"formRole",label:"表单内角色"},{default:s(()=>[b(" 待添加... ")]),_:1})):T("",!0),e(h,{prop:"method",label:"多人审批方式"},{default:s(()=>[e($,{class:"flex-column",modelValue:d(l).multi,"onUpdate:modelValue":a[4]||(a[4]=m=>d(l).multi=m)},{default:s(()=>[e(p,{label:"sequential"},{default:s(()=>[b("依次审批")]),_:1}),e(p,{label:"joint"},{default:s(()=>[b("会签（需要所有审批人都通过才可通过）")]),_:1}),e(p,{label:"single"},{default:s(()=>[b("或签（其中一名审批人通过或驳回即可）")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(h,{prop:"nobody",label:"审批人为空"},{default:s(()=>[e($,{modelValue:d(l).nobody,"onUpdate:modelValue":a[5]||(a[5]=m=>d(l).nobody=m)},{default:s(()=>[e(p,{label:"pass"},{default:s(()=>[b("自动通过")]),_:1}),e(p,{label:"reject"},{default:s(()=>[b("自动驳回")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{label:"表单权限",name:"formPermissions"},{default:s(()=>[b(" 待添加... ")]),_:1}),e(C,{label:"操作权限",name:"operationPermissions"},{default:s(()=>[y("div",xo,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(xt))]),_:1}),y("div",Vo,[e(f,{tag:"b"},{default:s(()=>[b(" 同意 ")]),_:1}),$o]),e(x,{modelValue:d(l).operations.complete,"onUpdate:modelValue":a[6]||(a[6]=m=>d(l).operations.complete=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",wo,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(Ie))]),_:1}),y("div",ko,[e(f,{tag:"b"},{default:s(()=>[b(" 拒绝 ")]),_:1}),Co]),e(x,{modelValue:d(l).operations.refuse,"onUpdate:modelValue":a[7]||(a[7]=m=>d(l).operations.refuse=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",Eo,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(Vt))]),_:1}),y("div",No,[e(f,{tag:"b"},{default:s(()=>[b(" 转办 ")]),_:1}),Po]),e(x,{modelValue:d(l).operations.transfer,"onUpdate:modelValue":a[8]||(a[8]=m=>d(l).operations.transfer=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",Io,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(ce))]),_:1}),y("div",Uo,[e(f,{tag:"b"},{default:s(()=>[b(" 加签 ")]),_:1}),To]),e(x,{modelValue:d(l).operations.addMulti,"onUpdate:modelValue":a[9]||(a[9]=m=>d(l).operations.addMulti=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g),y("div",Ao,[e(N,{size:32,class:"flow-opt-item__icon"},{default:s(()=>[e(d(Ue))]),_:1}),y("div",So,[e(f,{tag:"b"},{default:s(()=>[b(" 减签 ")]),_:1}),zo]),e(x,{modelValue:d(l).operations.minusMulti,"onUpdate:modelValue":a[10]||(a[10]=m=>d(l).operations.minusMulti=m),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),e(g)]),_:1})]),_:1},8,["modelValue"])}}});const Ro=U(Oo,[["__scopeId","data-v-05119c57"]]),Bo=w({__name:"CcAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:n}){const t=r,o=E("properties"),{node:l}=X(t,n);return(i,a)=>{const p=ze,$=ke,h=Ce,c=ie;return _(),V(d(fe),{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=u=>o.value=u),stretch:"",block:!1},{default:s(()=>[e(c,{label:"设置抄送人",name:"properties"},{default:s(()=>[e(h,{"label-position":"top","label-width":"90px"},{default:s(()=>[e($,{prop:"users",label:"抄送人"},{default:s(()=>[e(p,{multiple:"",placeholder:"请选择人员",modelValue:d(l).users,"onUpdate:modelValue":a[0]||(a[0]=u=>d(l).users=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,{label:"表单权限",name:"formPermissions"},{default:s(()=>[b(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),Mo=w({__name:"StartAttr",props:{node:{}},emits:["update:node"],setup(r,{emit:n}){const t=r,o=E("formPermissions");return X(t,n),(l,i)=>{const a=ie;return _(),V(d(fe),{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=p=>o.value=p),stretch:"",block:!1},{default:s(()=>[e(a,{label:"表单权限",name:"formPermissions"},{default:s(()=>[b(" 待添加... ")]),_:1}),e(a,{label:"操作权限",name:"operationPermissions"},{default:s(()=>[b(" 待添加... ")]),_:1})]),_:1},8,["modelValue"])}}}),Lo=["id"],jo=w({__name:"index",setup(r,{expose:n}){const t={start:Mo,approval:Ro,cc:Bo};let o=E({id:"",pid:"",type:"",name:"",child:null});const l=E(!1),i=E(!1),a=()=>{i.value&&(i.value=!1)};return n({open:$=>{o.value=$,l.value=!0}}),($,h)=>{const c=re,u=pt,f=_t;return _(),V(f,{modelValue:l.value,"onUpdate:modelValue":h[2]||(h[2]=v=>l.value=v),size:"35%"},{header:s(({titleId:v,titleClass:k})=>[y("span",{id:v,class:L(k)},[F(e(c,{onBlur:a,maxlength:"30",modelValue:d(o).name,"onUpdate:modelValue":h[0]||(h[0]=I=>d(o).name=I)},null,8,["modelValue"]),[[d(Ve),a],[G,i.value]]),F(e(u,{icon:"EditPen",onClick:h[1]||(h[1]=I=>i.value=!0)},{default:s(()=>[b(A(d(o).name),1)]),_:1},512),[[G,!i.value]])],10,Lo)]),default:s(()=>[(_(),V(se(t[d(o).type]),{node:d(o)},null,8,["node"]))]),_:1},8,["modelValue"])}}});const Fo=U(jo,[["__scopeId","data-v-e9c31a05"]]),qo=r=>{const n=()=>{let c=`node-${Math.random().toString(36).substring(2,7)}`;const u=(f,v)=>{if(f.id===v)return!0;if(f.child)return u(f.child,v);if("children"in f){const k=f;if(k.children&&k.children.length>0)return k.children.some(I=>u(I,v))}return!1};return u(r,c)?n():c},t=c=>{const u=c;u.children.unshift({id:n(),pid:c.id,type:"condition",def:!1,name:`条件${u.children.length+1}`,conditions:{logicalOperator:"and",conditions:[{field:null,operator:"",value:null}],groups:[]},child:null})},a={condition:t,approval:c=>{const u=c.child,f=n();c.child={id:f,pid:c.id,type:"approval",name:"审批人",child:u,assigneeType:"user",users:[],roles:[],leader:1,multi:"sequential",choice:!1,self:!1,nobody:"reject",operations:{complete:!0,refuse:!0,transfer:!1,addMulti:!1,minusMulti:!1}},u&&(u.pid=f)},cc:c=>{const u=c.child,f=n();c.child={id:f,pid:c.id,type:"cc",name:"抄送人",child:u,users:[]},u&&(u.pid=f)},exclusive:c=>{const u=c.child,f=n(),v={id:f,pid:c.id,type:"exclusive",name:"独占网关",child:u,children:[]};if(c.child=v,u&&(u.pid=f),t(c.child),t(c.child),v.children.length>0){const k=v.children[v.children.length-1];k.def=!0,k.name="默认条件"}}},p=(c,u)=>{const f=a[c];f&&f(u)},$=c=>{h(r,c)},h=(c,u)=>{var f;if(c.id===u.pid)if("children"in c&&((f=c.child)==null?void 0:f.id)!==u.id){const v=c,k=v.children.findIndex(I=>I.id===u.id);k!==-1&&(v.children.length<=2?$(v):v.children.splice(k,1))}else u.child&&u.child.pid&&(u.child.pid=c.id),c.child=u.child;else if(c.child&&h(c.child,u),"children"in c){const v=c;v.children&&v.children.length>0&&v.children.forEach(k=>{h(k,u)})}};return{addNode:p,delNode:$}},Do={class:"designer-container"},Ho={class:"zoom"},Go={class:"node-container"},Ko=w({name:"flowDesign"}),Wo=w({...Ko,setup(r){be(h=>({dd50d9ae:l.value}));const n=E(),t=ae({id:"root",pid:null,type:"start",name:"发起人",child:{id:"end",pid:"root",type:"end",name:"结束",child:null}}),o=E(100),l=M(()=>o.value/100),i=h=>{var c;(c=n.value)==null||c.open(h)},{addNode:a,delNode:p}=qo(t);Ge("nodeHooks",{readOnly:!1,addNode:a,delNode:p,openPenal:i});const $=h=>{h.shiftKey&&(h.deltaY>0?o.value>50&&(o.value-=10):o.value<170&&(o.value+=10))};return window.addEventListener("wheel",$),Ke(()=>{window.removeEventListener("wheel",$)}),(h,c)=>{const u=j;return _(),P("div",Do,[y("div",Ho,[e(u,{icon:d(ce),onClick:c[0]||(c[0]=f=>o.value+=10),disabled:o.value>=170,circle:""},null,8,["icon","disabled"]),y("span",null,A(o.value)+"%",1),e(u,{icon:d(Ue),onClick:c[1]||(c[1]=f=>o.value-=10),circle:"",disabled:o.value<=50},null,8,["icon","disabled"])]),y("div",Go,[e(Se,{node:t},null,8,["node"])]),e(Fo,{ref_key:"nodePenalRef",ref:n},null,512)])}}});const Jo=U(Wo,[["__scopeId","data-v-561de022"]]),Xo=w({__name:"App",setup(r){return(n,t)=>{const o=ft;return _(),V(o,{namespace:"el",locale:d(mt)},{default:s(()=>[e(Jo)]),_:1},8,["locale"])}}});const ee=[{id:1,name:"张三",username:"admin",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:2,name:"李四",username:"lisi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:3,name:"王五",username:"wangwu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:4,name:"赵六",username:"zhaoliu",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:5,name:"孙七",username:"sunqi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:6,name:"周八",username:"zhouba",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:7,name:"吴九",username:"wujui",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"},{id:8,name:"郑十",username:"zhengshi",avatar:"https://avatars.githubusercontent.com/u/44080404?v=4"}],Yo=[{url:"/api/user/info",method:"get",response:r=>{const n=r.query.username;return{code:200,success:!0,message:"操作成功",data:ee.find(t=>t.username===n)}}},{url:"/api/user/list",method:"post",response:r=>{const n=r.body.userIds;return{code:200,success:!0,message:"操作成功",data:Array.isArray(n)?ee.filter(t=>n.includes(t.username)):ee}}}],Zo=[...Yo],Qo=[...Zo];function en(){wt(Qo)}const tn=We(Xo);tn.mount("#app");en();
